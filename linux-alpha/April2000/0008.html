<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=KS_C_5601-1987">
<TITLE>Linux Alpha List: Alpha clock problem</TITLE>
<META NAME="Author" CONTENT="Soohoon Lee (Soohoon.Lee@alpha-processor.com)">
<META NAME="Subject" CONTENT="Alpha clock problem">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Alpha clock problem</H1>
<HR>
<P>
<!-- received="Fri Apr 21 08:11:31 2000" -->
<!-- isoreceived="20000421151131" -->
<!-- sent="Thu, 20 Apr 2000 23:27:56 -0400" -->
<!-- isosent="20000421032756" -->
<!-- name="Soohoon Lee" -->
<!-- email="Soohoon.Lee@alpha-processor.com" -->
<!-- subject="Alpha clock problem" -->
<!-- id="278EEF4F1348D211940600A0C95BCF7F3B21A9@yellow-fin" -->
<!-- charset="KS_C_5601-1987" -->
<STRONG>Subject: </STRONG>Alpha clock problem<BR>
<STRONG>From: </STRONG>Soohoon Lee (<EM>Soohoon.Lee@alpha-processor.com</EM>)<BR>
<STRONG>Date: </STRONG>Thu Apr 20 2000 - 20:27:56 PDT
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#8">[ date ]</A>
<A HREF="index.html#8">[ thread ]</A>
<A HREF="subject.html#8">[ subject ]</A>
<A HREF="author.html#8">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0009.html">Ivan Kokshaysky: "Re: non-executable stack on alpha (was Re: Security in general ..)"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0007.html">Michael H. Warfield: "Re: non-executable stack on alpha (was Re: Security in general ..)"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0011.html">Soohoon Lee: "RE: Alpha clock problem"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
Alpha clock sometimes slow, sometimes fast.
<BR>
Tested platform is UP2000, Redhat 6.2, 2.2.14-6.0 and 2.3.99-pre3, 
<BR>
both kernels are configured to support SMP.
<BR>
Analysis of kernel source is.
<BR>
1. Alpha kernel code increase/adjust time value based on rpcc value.
<BR>
2. Accurate clock speed(cycle frequency) is very important to caculate rpcc
<BR>
value.
<BR>
3. kernel code gets cycle frequency from hwrpb-&gt;cycle_freq but if there's
<BR>
more than 1%
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;difference btw. the value and measured one then kernel uses
<BR>
measured one.
<BR>
<P>And the cycle frequency value caused the problem when it's not accurate.
<BR>
By over/under estimating the cycle frequency, time goes fast or slow.
<BR>
Here's an example.
<BR>
CPU clock is 700MHz but /proc/cpuinfo reports
<BR>
<P>cycle frequency [Hz]    : 699300699 
<BR>
platform string         : API UP1000 699 MHz
<BR>
<P>the freq. must be 700000000 so diff. btw those two are
<BR>
700000000 - 699300699 = 699301
<BR>
approx. 700000 error per sec. it's
<BR>
700000/700000000 = 0.001sec error/sec
<BR>
0.001 * 24 * 60 * 60 = 86.400 sec errir/day.
<BR>
<P>1MHz error makes 1:30 sec error.
<BR>
Following is UP2000 with 600Mhz CPU
<BR>
As you can guess It'll get approx. 3min error per day.
<BR>
<P>cycle frequency [Hz]    : 598802395 
<BR>
platform string         : AlphaPC 264DP 598 MHz
<BR>
<P>Kernel tries to detect the frequency because the info from SRM is not
<BR>
correct sometimes.
<BR>
(comment in the source file said so), But we can guess the measured value
<BR>
was also inaccurate.
<BR>
I think we cannot measure the frequency accurately always. 
<BR>
So what about rounding off the frequency count?
<BR>
<P>Soohoon.
<BR>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0009.html">Ivan Kokshaysky: "Re: non-executable stack on alpha (was Re: Security in general ..)"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0007.html">Michael H. Warfield: "Re: non-executable stack on alpha (was Re: Security in general ..)"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0011.html">Soohoon Lee: "RE: Alpha clock problem"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Mon May 01 2000 - 18:42:06 PDT</EM>
</EM>
</SMALL>
</BODY>
</HTML>
