<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Linux Alpha List: 2.3.49 axp ptrace icache flush</TITLE>
<META NAME="Author" CONTENT="Richard Henderson (rth@cygnus.com)">
<META NAME="Subject" CONTENT="2.3.49 axp ptrace icache flush">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>2.3.49 axp ptrace icache flush</H1>
<HR>
<P>
<!-- received="Wed Mar 01 11:15:54 2000" -->
<!-- isoreceived="20000301191554" -->
<!-- sent="Tue, 29 Feb 2000 22:57:27 -0800" -->
<!-- isosent="20000301065727" -->
<!-- name="Richard Henderson" -->
<!-- email="rth@cygnus.com" -->
<!-- subject="2.3.49 axp ptrace icache flush" -->
<!-- id="20000229225727.A225@castro.cygnus.com" -->
<STRONG>Subject: </STRONG>2.3.49 axp ptrace icache flush<BR>
<STRONG>From: </STRONG>Richard Henderson (<EM>rth@cygnus.com</EM>)<BR>
<STRONG>Date: </STRONG>Tue Feb 29 2000 - 22:57:27 PST
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#177">[ date ]</A>
<A HREF="index.html#177">[ thread ]</A>
<A HREF="subject.html#177">[ subject ]</A>
<A HREF="author.html#177">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0178.html">Roman Zippel: "Re: new IRQ scalability changes in 2.3.48"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0176.html">Richard Henderson: "2.3.49-2 axp iommu update"</A>
<!-- nextthread="start" -->
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
GDB doesn't work currently.  This is especially visible on EV6,
<BR>
though faulty behaviour can be seen on previous chips as well.
<BR>
<P>Some typical failure modes:
<BR>
<P>---- try 1 
<BR>
(gdb) b main
<BR>
Breakpoint 1 at 0x120000498: file zz.c, line 56.
<BR>
(gdb) run
<BR>
Starting program: /home/rth/./a.out
<BR>
<P>Program received signal SIGTRAP, Trace/breakpoint trap.
<BR>
0x2000000752c in dl_main (phdr=0x0, phent=0, user_entry=0x0) at rtld.c:1053
<BR>
1053    rtld.c: No such file or directory.
<BR>
(gdb) c
<BR>
Continuing.
<BR>
<P>Program received signal SIGSEGV, Segmentation fault.
<BR>
dl_main (phdr=0x0, phent=0, user_entry=0x0) at rtld.c:1058
<BR>
1058    in rtld.c
<BR>
---- try 2
<BR>
(gdb) run
<BR>
The program being debugged has been started already.
<BR>
Start it from the beginning? (y or n) y
<BR>
Starting program: /home/rth/./a.out
<BR>
<P>Breakpoint 1, main () at zz.c:56
<BR>
56              for (i = 0; i &lt; 5; ++i) {
<BR>
(gdb) n
<BR>
*hang*
<BR>
---- try 3
<BR>
(gdb) run
<BR>
The program being debugged has been started already.
<BR>
Start it from the beginning? (y or n) y
<BR>
Starting program: /home/rth/./a.out
<BR>
<P>Program received signal SIGTRAP, Trace/breakpoint trap.
<BR>
0x20000010cac in _dl_init_next (searchlist=0x2000001e358) at dl-init.c:79
<BR>
79      dl-init.c: No such file or directory.
<BR>
(gdb) c
<BR>
Continuing.
<BR>
<P>Breakpoint 1, main () at zz.c:56
<BR>
56              for (i = 0; i &lt; 5; ++i) {
<BR>
(gdb) n
<BR>
57                      before = get_cycles();
<BR>
(gdb)
<BR>
58                      eat(andrea(make()));
<BR>
(gdb)
<BR>
<P>Program received signal SIGTRAP, Trace/breakpoint trap.
<BR>
0x120000664 in make () at zz.c:5
<BR>
5       {
<BR>
<PRE>
----
<P>The solution, of course, is to flush the icache by some method.
In this case, by making use of the icache asn tags.
<P>The flush_icache_page hook is used by more than ptrace.  The
uses in do_swap_page and do_no_page probably don't need this,
but I can't be sure.  I think the reason we havn't seen anything
in this area is that flush_tlb_range also allocates a new asn,
and swapping doesn't change the end-result contents of the 
virtual page for any one process.
<P><P>r~
<P><P></PRE>
<HR>
<UL>
<LI>text/plain attachment: <A HREF="att-a-2348-icache_">-2348-icache_</A>
</UL>
<!-- attachment="att-a-2348-icache_" -->
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0178.html">Roman Zippel: "Re: new IRQ scalability changes in 2.3.48"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0176.html">Richard Henderson: "2.3.49-2 axp iommu update"</A>
<!-- nextthread="start" -->
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Wed Mar 01 2000 - 06:26:28 PST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
