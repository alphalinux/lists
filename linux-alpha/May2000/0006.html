<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=KS_C_5601-1987">
<TITLE>Linux Alpha List: eepro100 timeout error, bug.</TITLE>
<META NAME="Author" CONTENT="Soohoon Lee (Soohoon.Lee@alpha-processor.com)">
<META NAME="Subject" CONTENT="eepro100 timeout error, bug.">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>eepro100 timeout error, bug.</H1>
<HR>
<P>
<!-- received="Wed May 10 21:24:17 2000" -->
<!-- isoreceived="20000511042417" -->
<!-- sent="Wed, 10 May 2000 16:47:35 -0400" -->
<!-- isosent="20000510204735" -->
<!-- name="Soohoon Lee" -->
<!-- email="Soohoon.Lee@alpha-processor.com" -->
<!-- subject="eepro100 timeout error, bug." -->
<!-- id="278EEF4F1348D211940600A0C95BCF7F3B21E6@yellow-fin" -->
<!-- charset="KS_C_5601-1987" -->
<STRONG>Subject: </STRONG>eepro100 timeout error, bug.<BR>
<STRONG>From: </STRONG>Soohoon Lee (<EM>Soohoon.Lee@alpha-processor.com</EM>)<BR>
<STRONG>Date: </STRONG>Wed May 10 2000 - 13:47:35 PDT
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#6">[ date ]</A>
<A HREF="index.html#6">[ thread ]</A>
<A HREF="subject.html#6">[ subject ]</A>
<A HREF="author.html#6">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0007.html">Soohoon Lee: "PCI configuration problem in 2.3.99 prex"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0005.html">Scott Brown: "Problems with DEC Ethernet Controller"</A>
<!-- nextthread="start" -->
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
I'm having troble with eepro100 on 2.3.99-prex.
<BR>
It generates timeout error very often.
<BR>
I thought it is alpha platform problem but it's new driver's bug.
<BR>
There's a race condition problem in speedo_start_xmit().
<BR>
The driver does read-modify-write and mean while 8255x write something
<BR>
to the same address. So I change the operation automic.
<BR>
Old driver(in 2.2.14) doesn't have the problem.
<BR>
What about seperating one 4bytes field to two 2byte fields.
<BR>
<P>Soohoon.
<BR>
<P>diff -w drivers/net/eepro100.c ~/linux/drivers/net/eepro100.c
<BR>
899c899
<BR>
&lt; /* #if 0 - Alphas need this or else they come up in 10 Mbit mode */
<BR>
<PRE>
---
&gt; #if 0
916c916
&lt; /* #endif */
---
&gt; #endif
1221,1223c1221
&lt; //                    last_cmd-&gt;cmd_status &amp;= cpu_to_le32(~(CmdSuspend |
CmdIntr));
&lt;                       clear_bit(30, &amp;last_cmd-&gt;cmd_status);
&lt;                       clear_bit(29, &amp;last_cmd-&gt;cmd_status);
---
&gt;                       last_cmd-&gt;cmd_status &amp;= cpu_to_le32(~(CmdSuspend |
CmdIntr));
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0007.html">Soohoon Lee: "PCI configuration problem in 2.3.99 prex"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0005.html">Scott Brown: "Problems with DEC Ethernet Controller"</A>
<!-- nextthread="start" -->
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Thu Jun 01 2000 - 09:46:28 PDT</EM>
</EM>
</SMALL>
</BODY>
</HTML>
