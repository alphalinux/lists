<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Linux Alpha List: Re: Calling testers for another Dead Function</TITLE>
<META NAME="Author" CONTENT="Graham Stoney (greyham@research.canon.com.au )">
<META NAME="Subject" CONTENT="Re: Calling testers for another Dead Function Optimisation update">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: Calling testers for another Dead Function Optimisation update</H1>
<HR>
<P>
<!-- received="Wed May 17 10:56:36 2000" -->
<!-- isoreceived="20000517175636" -->
<!-- sent="Tue, 16 May 2000 12:07:16 +1000 (EST)" -->
<!-- isosent="20000516020716" -->
<!-- name="Graham Stoney" -->
<!-- email="greyham@research.canon.com.au " -->
<!-- subject="Re: Calling testers for another Dead Function Optimisation update" -->
<!-- id="20000516020716.EF7F43C95E@elph.research.canon.com.au" -->
<!-- inreplyto="391EECB7.2F5670E7@netx4.com" -->
<STRONG>Subject: </STRONG>Re: Calling testers for another Dead Function Optimisation update<BR>
<STRONG>From: </STRONG>Graham Stoney (<EM>greyham@research.canon.com.au </EM>)<BR>
<STRONG>Date: </STRONG>Mon May 15 2000 - 19:07:16 PDT
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#30">[ date ]</A>
<A HREF="index.html#30">[ thread ]</A>
<A HREF="subject.html#30">[ subject ]</A>
<A HREF="author.html#30">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0031.html">Jamie Lokier: "Re: Calling testers for another Dead Function Optimisation update"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0029.html">Dan Malek: "Re: Calling testers for another Dead Function Optimisation update"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0027.html">Dan Malek: "Re: Calling testers for another Dead Function Optimisation update"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0031.html">Jamie Lokier: "Re: Calling testers for another Dead Function Optimisation update"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0027.html">Graham Stoney: "Re: Calling testers for another Dead Function Optimisation update"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
Dan Malek writes:
<BR>
<EM>&gt; This is the way the kernel used to be, with the kernel objects
</EM><BR>
<EM>&gt; as *.a files instead of *.o files.
</EM><BR>
<P>I'm definitely with you on this one. Using ld -r in intermediate stages is
<BR>
defeating the linker's natural ability to exclude unused objects. My patch
<BR>
achieves a similar effect by allowing the linker to exclude unused functions,
<BR>
but it does so in a very torturous way. I'd prefer to have both .a's for
<BR>
wholesale dead object elimination _and_ -ffunction-sections for elimination of
<BR>
any remaining dead functions.
<BR>
<P><EM>&gt; The response I received was the change was due to loadable modules, that
</EM><BR>
<EM>&gt; when you link the kernel as a bunch of *.a files the result is usually
</EM><BR>
<EM>&gt; missing lots of functions that a loadable module may want to call.
</EM><BR>
<P>Like you, I don't understand the logic behind this either. Any symbol
<BR>
accessible from a loadable module will have a magic reference thanks to
<BR>
EXPORT_SYMBOL that will drag it in from the archive.
<BR>
<P>The only use I can see for using ld -r is while building the loadable modules
<BR>
themselves, to simplify things for the user by combining modules which would
<BR>
otherwise contain multiple objects. And I guess this is simply so &quot;insmod&quot;
<BR>
doesn't have to handle archives directly.
<BR>
<P><EM>&gt; &gt; I think/hope we're getting close to something that could be accepted into
</EM><BR>
<EM>&gt; &gt; the official kernel now.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Who gave you that indication?  I wouldn't even try to check any of
</EM><BR>
<EM>&gt; this into the kernel sources based upon past discussions.
</EM><BR>
<P>I can't check it in myself, but I can ask as many people as possible to test
<BR>
it. If it works OK, it's got a chance of inclusion in 2.4/2.5. Embedded
<BR>
systems people who want it can use it as-is on 2.2 too.
<BR>
<P>Regards,
<BR>
Graham
<BR>
<PRE>
-- 
Graham Stoney
Principal Hardware/Software Engineer
Canon Information Systems Research Australia
Ph: +61 2 9805 2909  Fax: +61 2 9805 2929
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0031.html">Jamie Lokier: "Re: Calling testers for another Dead Function Optimisation update"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0029.html">Dan Malek: "Re: Calling testers for another Dead Function Optimisation update"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0027.html">Dan Malek: "Re: Calling testers for another Dead Function Optimisation update"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0031.html">Jamie Lokier: "Re: Calling testers for another Dead Function Optimisation update"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0027.html">Graham Stoney: "Re: Calling testers for another Dead Function Optimisation update"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Thu Jun 01 2000 - 09:46:28 PDT</EM>
</EM>
</SMALL>
</BODY>
</HTML>
