<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Linux Alpha List: Re: new IRQ scalability changes in 2.3.48</TITLE>
<META NAME="Author" CONTENT="yodaiken@fsmlabs.com (yodaiken@fsmlabs.com)">
<META NAME="Subject" CONTENT="Re: new IRQ scalability changes in 2.3.48">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: new IRQ scalability changes in 2.3.48</H1>
<HR>
<P>
<!-- received="Mon Mar 13 03:55:10 2000" -->
<!-- isoreceived="20000313115510" -->
<!-- sent="Sun, 12 Mar 2000 15:38:18 -0700" -->
<!-- isosent="20000312223818" -->
<!-- name="yodaiken@fsmlabs.com" -->
<!-- email="yodaiken@fsmlabs.com" -->
<!-- subject="Re: new IRQ scalability changes in 2.3.48" -->
<!-- id="20000312153818.A28209@hq.fsmlabs.com" -->
<!-- inreplyto="Pine.LNX.4.10.10003120944340.5794-100000@penguin.transmeta.com" -->
<STRONG>Subject: </STRONG>Re: new IRQ scalability changes in 2.3.48<BR>
<EM>yodaiken@fsmlabs.com</EM><BR>
<STRONG>Date: </STRONG>Sun Mar 12 2000 - 14:38:18 PST
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#35">[ date ]</A>
<A HREF="index.html#35">[ thread ]</A>
<A HREF="subject.html#35">[ subject ]</A>
<A HREF="author.html#35">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0036.html">Linus Torvalds: "Re: new IRQ scalability changes in 2.3.48"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0034.html">Linus Torvalds: "Re: new IRQ scalability changes in 2.3.48"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0034.html">Linus Torvalds: "Re: new IRQ scalability changes in 2.3.48"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0036.html">Linus Torvalds: "Re: new IRQ scalability changes in 2.3.48"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0034.html">yodaiken@fsmlabs.com: "Re: new IRQ scalability changes in 2.3.48"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
On Sun, Mar 12, 2000 at 09:53:29AM -0800, Linus Torvalds wrote:
<BR>
<EM>&gt; Doing an __sti in interrupts will let higher-priority interrupts in. As it
</EM><BR>
<EM>&gt; always has.
</EM><BR>
<P>Previously, _any_ interrupt was let to progress.   That is, hardware
<BR>
priorities were ignored by Linux.
<BR>
<P><EM>&gt; I think it's probably stupid most of the time, and shows that something is
</EM><BR>
<EM>&gt; wrong (an interrupt should not take long enough for it to matter that we
</EM><BR>
<EM>&gt; do an __sti), but sometimes that kind of stupidity is a result of horrible
</EM><BR>
<EM>&gt; hardware latencies (eg the time it takes to read a sector from the IDE
</EM><BR>
<EM>&gt; disk using programmed IO).
</EM><BR>
<P>So if we have a hardware determined higher priority level IDE than level
<BR>
network, then it previously was the case that if the IDE driver was polite
<BR>
and did an __sti, the network was assured of a relatively low latency. However,
<BR>
the network now may need to wait until the programmed i/o completes.
<BR>
Probably programmed i/o should rather happen in soft_interrupt space, but
<BR>
with the current drivers it does not.
<BR>
<P><EM>&gt; Quite regardless of how you do interrupts: it doesn't matter where youput
</EM><BR>
<EM>&gt; the ACK's, you always need to make sure that irq masking etc is correct,
</EM><BR>
<EM>&gt; and you must NOT allow a context switch while an interrupt handler is
</EM><BR>
<EM>&gt; still running.
</EM><BR>
<P>Ok. Ingo: does your &quot;low latency&quot; patch violate this rule?
<BR>
<P><EM>&gt; You're making these problems up.
</EM><BR>
<P>Yes. I thought that the hardware worked like 8259s, but it is somewhat 
<BR>
more sensible.
<BR>
<P><EM>&gt; &gt; I really dislike hardware interrupt  priorities since they have nothing
</EM><BR>
<EM>&gt; &gt; to do with the OS' ideas of importance and are complex to work with.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; I agree. I think interrupt controllers should be simple masks, nothing
</EM><BR>
<EM>&gt; more, nothing less.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; However, I'm not designing the hardware.
</EM><BR>
<P>It's amazing how stubbornly hardware folks refuse to consider OS in their
<BR>
designs.
<BR>
<P>---------------------------------------------------------
<BR>
Victor Yodaiken 
<BR>
FSMLabs:  www.fsmlabs.com  www.rtlinux.com
<BR>
FSMLabs is a servicemark and a service of 
<BR>
VJY Associates L.L.C, New Mexico.
<BR>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0036.html">Linus Torvalds: "Re: new IRQ scalability changes in 2.3.48"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0034.html">Linus Torvalds: "Re: new IRQ scalability changes in 2.3.48"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0034.html">Linus Torvalds: "Re: new IRQ scalability changes in 2.3.48"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0036.html">Linus Torvalds: "Re: new IRQ scalability changes in 2.3.48"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0034.html">yodaiken@fsmlabs.com: "Re: new IRQ scalability changes in 2.3.48"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Sat Apr 01 2000 - 04:15:03 PST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
