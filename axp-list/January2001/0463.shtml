<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN"> 
     <HTML> 
     <HEAD> 
     <TITLE>Axp-List Archive</TITLE> 
     <LINK REV="made" HREF="mailto:mailto-address"> 
     <HEAD> 
     <BODY BGCOLOR="#DC9D33" TEXT="#000000" LINK="#DD0000" ALINK="#CC0000" VLINK="#CC0000">
		<CENTER>  <!--#exec cgi="/cgi-bin/banmat1.cgi"--></CENTER>

     <H1 ALIGN=CENTER>Axp-List Archive<BR> 2.4.x/alpha/ALI chipset/IDE problems summary Re: 2.4.1 not fully sane on Alpha - file systems</H1> 
	
<!-- received="Thu Feb 01 21:06:23 2001" -->
<!-- isoreceived="20010202050623" -->
<!-- sent="Thu, 1 Feb 2001 15:38:40 -0500" -->
<!-- isosent="20010201203840" -->
<!-- name="John Jasen" -->
<!-- email="jjasen1@umbc.edu" -->
<!-- subject="2.4.x/alpha/ALI chipset/IDE problems summary Re: 2.4.1 not fully sane on Alpha - file systems" -->
<!-- id="Pine.SGI.4.31L.02.0102011526200.71788-100000@irix2.gl.umbc.edu" -->
<!-- inreplyto="20010201092342.B15101@ellpspace.math.ualberta.ca" -->
<STRONG>Subject: </STRONG>2.4.x/alpha/ALI chipset/IDE problems summary Re: 2.4.1 not fully sane on Alpha - file systems<BR>
<STRONG>From: </STRONG>John Jasen (<EM>jjasen1@umbc.edu</EM>)<BR>
<STRONG>Date: </STRONG>Thu Feb  1 12:38:40 2001
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.shtml#463">[ date ]</A>
<A HREF="index.shtml#463">[ thread ]</A>
<A HREF="subject.shtml#463">[ subject ]</A>
<A HREF="author.shtml#463">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0464.shtml">Ingo T. Storm: "Re: bad routing performance in AS200"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0462.shtml">Arkadiy Chapkis - Arc: "Flash player"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0465.shtml">Maurice Hilarius: "Re: 2.4.x/alpha/ALI chipset/IDE problems summary Re: 2.4.1 not fully sane on Alpha - file systems"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
The system in question is an API UP1100 based system, running 4 Maxtor
<BR>
40gb IDE drives off the ALI M15x3 chipset.
<BR>
<P>This applies to kernel 2.4.0 and 2.4.1.
<BR>
<P>The drives are identified as follows from hdparm:
<BR>
<P>Model=Maxtor 54098H8, FwRev=DAC10SC0, SerialNo=K80F1ZFC
<BR>
<P>Is also has an Adaptec 29160 SCSI card, running a solid state disk and an
<BR>
AIT tape library.
<BR>
<P>Upon placing any heavy I/O load on any of the disks (dd if=/dev/*d*
<BR>
of=/dev/null) the screen flashes a  few times, and then the system locks
<BR>
hard -- no sysrq, no control-alt-del, no pings, no nothing.
<BR>
<P>It will also hang and lock hard on fscking corrupted filesystems under
<BR>
2.4.0 and 2.4.1.
<BR>
<P>Interestingly enough, I tried 'dd if=/dev/zero of=/tmp/dd.img bs=4096
<BR>
count=10000' and it also locked hard, after printing messages to the
<BR>
effect of:
<BR>
<P>EXT2-fs error: (device info) allocating block in system zone -- block
<BR>
(block numbers).
<BR>
<P>stock RH 2.2.16-3 works peachy.
<BR>
<P>I've tried various options with compiling in and out the ALI chipset, PCI
<BR>
DMA, drive DMA, and IRQ sharing, but without all four of those enabled,
<BR>
the system freezes at identifying the IDE device partitions, like so:
<BR>
<P>&nbsp;&nbsp;hda: lost interrupt
<BR>
lost interrupt
<BR>
lost interrupt
<BR>
<P>I've heard one other report of similar problems on the linux-kernel
<BR>
mailing list, and at least one other on the axp-list.
<BR>
<P>On Thu, 1 Feb 2001, Michal Jaegermann wrote:
<BR>
<P><EM>&gt; Date: Thu, 1 Feb 2001 09:23:42 -0700
</EM><BR>
<EM>&gt; From: Michal Jaegermann &lt;michal@ellpspace.math.ualberta.ca&gt;
</EM><BR>
<EM>&gt; To: John Jasen &lt;jjasen@datafoundation.com&gt;
</EM><BR>
<EM>&gt; Cc: linux-kernel@vger.kernel.org
</EM><BR>
<EM>&gt; Subject: Re: 2.4.1 not fully sane on Alpha - file systems
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; On Thu, Feb 01, 2001 at 10:46:12AM -0500, John Jasen wrote:
</EM><BR>
<EM>&gt; &gt; On Wed, 31 Jan 2001, Michal Jaegermann wrote:
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt; &gt; I just tried to boot 2.4.1 kernel on Alpha UP1100.  This machine
</EM><BR>
<EM>&gt; &gt; &gt; happens to have two SCSI disks on sym53c875 controller and two IDE
</EM><BR>
<EM>&gt; &gt; &gt; drives hooked to a builtin &quot;Acer Laboratories Inc. [ALi] M5229 IDE&quot;.
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt; ALI M1535D pci-ide bridge, isn't it? That's what the specs on
</EM><BR>
<EM>&gt; &gt; API's webpage seem to indicate.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; 'lspci' claims that this is:
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; &quot;07.0  Acer Laboratories Inc. [ALi] M1533 PCI to ISA Bridge [Aladdin IV]&quot;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt; Try this for fun: dd if=/dev/hda of=/dev/null bs=4096, and see if it
</EM><BR>
<EM>&gt; &gt; cronks out.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; Probably.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; &gt; In my case, any serious I/O on the IDE drives quickly results in pretty
</EM><BR>
<EM>&gt; &gt; technicolor on the VGA screen, and then a hard lockup.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; No, no technicolor or other sounds effects.  The whole thing just
</EM><BR>
<EM>&gt; locks up with a power switch as the only option.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; &gt; Furthermore, after power-reset, 2.4.x, x=0 or 1, cannot successfully fsck
</EM><BR>
<EM>&gt; &gt; the drives.  It hangs after about the 2nd-3rd partition, again in a hard
</EM><BR>
<EM>&gt; &gt; lockup.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; My box is much healtier than that.  Regardless if I booted into a file
</EM><BR>
<EM>&gt; system on a SCSI drive or on an IDE drive (I happen to have those
</EM><BR>
<EM>&gt; options although I prefer IDE - I have there something which I can loose
</EM><BR>
<EM>&gt; without any real pain :-) I can still fsck drives healthy after the
</EM><BR>
<EM>&gt; crash but I did NOT risk fsck under 2.4.1.  Things looks way too screwy
</EM><BR>
<EM>&gt; for this.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt; My WAG is that there are problems in the ALI driver.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; Possibly, but I crashed the whole thing without mounting anything from
</EM><BR>
<EM>&gt; IDE drives at all.  There are still there but unused.  I simply managed
</EM><BR>
<EM>&gt; to get something in logs for the case described.  Note that errors
</EM><BR>
<EM>&gt; I quoted are from a device 08:05, i.e. SCSI driver (/dev/sda5 to be
</EM><BR>
<EM>&gt; more precise).  When my compiler went bonkers and started to read
</EM><BR>
<EM>&gt; clearly some random stuff instead of sources then the whole action was
</EM><BR>
<EM>&gt; happening on a SCSI drive.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;  Michal
</EM><BR>
<EM>&gt; -
</EM><BR>
<EM>&gt; To unsubscribe from this list: send the line &quot;unsubscribe linux-kernel&quot; in
</EM><BR>
<EM>&gt; the body of a message to majordomo@vger.kernel.org
</EM><BR>
<EM>&gt; Please read the FAQ at <A HREF="http://www.tux.org/lkml/">http://www.tux.org/lkml/</A>
</EM><BR>
<EM>&gt;
</EM><BR>
<P><PRE>
-- 
--
-- John E. Jasen (jjasen1@umbc.edu)
-- In theory, theory and practise are the same. In practise, they aren't.
<P><P><P><P>_______________________________________________
Axp-list mailing list
Axp-list@redhat.com
https://listman.redhat.com/mailman/listinfo/axp-list
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0464.shtml">Ingo T. Storm: "Re: bad routing performance in AS200"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0462.shtml">Arkadiy Chapkis - Arc: "Flash player"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0465.shtml">Maurice Hilarius: "Re: 2.4.x/alpha/ALI chipset/IDE problems summary Re: 2.4.1 not fully sane on Alpha - file systems"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR> 
     <P> 
     <SMALL> 
     <EM> 
     This archive was generated by  <A HREF="http://www.landfield.com/hypermail">hypermail version 2a22 </A> on Sat Mar  3 12:54:55 2001 PST <BR>
	Send any problems or questions about this archive to <A HREF="mailto:webmaster@alphalinux.org">webmaster@alphalinux.org</A>. 
     </EM> 
     </SMALL> 
     </BODY> 
     </HTML> 
