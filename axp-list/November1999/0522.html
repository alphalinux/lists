<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>AXP-List Hypermail Archive: Re: 21264 Alpha stuck spinlocks and</TITLE>
<META NAME="Author" CONTENT="Chance Reschke (reschke@astro.washington.edu)">
<META NAME="Subject" CONTENT="Re: 21264 Alpha stuck spinlocks and memory woes">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: 21264 Alpha stuck spinlocks and memory woes</H1>
<HR>
<P>
<!-- received="Mon Nov 15 10:34:09 1999" -->
<!-- isoreceived="19991115193409" -->
<!-- sent="Mon, 15 Nov 1999 11:33:23 -0800 (PST)" -->
<!-- isosent="19991115193323" -->
<!-- name="Chance Reschke" -->
<!-- email="reschke@astro.washington.edu" -->
<!-- subject="Re: 21264 Alpha stuck spinlocks and memory woes" -->
<!-- id="Pine.SGI.3.96.991115112445.4365J-100000@hermes.astro.washington.edu" -->
<!-- inreplyto="199911151825.NAA01827@localhost.localdomain" -->
<STRONG>Subject: </STRONG>Re: 21264 Alpha stuck spinlocks and memory woes<BR>
<STRONG>From: </STRONG>Chance Reschke (<EM>reschke@astro.washington.edu</EM>)<BR>
<STRONG>Date: </STRONG>Mon Nov 15 1999 - 10:33:23 AKST
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#522">[ date ]</A>
<A HREF="index.html#522">[ thread ]</A>
<A HREF="subject.html#522">[ subject ]</A>
<A HREF="author.html#522">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0523.html">Blake L. Carlson: "Re: Gtk+ - does it work on Alpha?"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0521.html">Jay.Estabrook@digital.com: "Re: 21264 Alpha stuck spinlocks and memory woes"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0521.html">Jay.Estabrook@digital.com: "Re: 21264 Alpha stuck spinlocks and memory woes"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0553.html">Paul Jakma: "Re: 21264 Alpha stuck spinlocks and memory woes"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0521.html">Chance Reschke: "Re: 21264 Alpha stuck spinlocks and memory woes"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0522.html">Chance Reschke: "Re: 21264 Alpha stuck spinlocks and memory woes"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
</PRE>
<P>
<EM>&gt; &gt;         socket.c:43 spinlock stuck in amd at fffffc00003a6eb8(0) owner
</EM><BR>
<EM>&gt; &gt;         xauth at fffffc000032ae14(1) sched.c:30
</EM><BR>
<EM>&gt; &gt; 
</EM><BR>
<EM>&gt; &gt; Warnings about stuck spinlocks are regularly logged by the kernel, but the
</EM><BR>
<EM>&gt; &gt; machine usually gets unstuck and carries on.  Is there anything we can do
</EM><BR>
<EM>&gt; &gt; to eliminate this problem?
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Is the above an example of one of the locks that does NOT come unstuck?
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; As you've noticed, there are occasions when a spinlock is held for a
</EM><BR>
<EM>&gt; very long time, during normal system operation. This is most apt to be
</EM><BR>
<EM>&gt; the &quot;kernel&quot; lock, which under 2.2 is still being used to manage a lot
</EM><BR>
<EM>&gt; of the kernel operations under SMP.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; If you have encountered cases in which the lock does NOT (eventually)
</EM><BR>
<EM>&gt; come unstuck, you may have found a deadlock condition that needs to be
</EM><BR>
<EM>&gt; investigated. Please try to collect as much information about those
</EM><BR>
<EM>&gt; cases as possible, and post here and to linux-kernel.
</EM><BR>
<P>You've described our situation exactly: quite a few &quot;kernel&quot; spinlocks
<BR>
that eventually come unstuck (a few seconds at most), and the occasional
<BR>
non-&quot;kernel&quot; spinlock that takes down the machine.  The example above is
<BR>
one of the latter.  In fact, I think the majority of these have been
<BR>
&quot;xauth&quot; stuck in &quot;amd&quot;.
<BR>
<P>What information should I try to collect the next time this happens?
<BR>
<P><EM>&gt; &gt; 2) We'd like to use 4GB of physical RAM on one of these machines, but the
</EM><BR>
<EM>&gt; &gt; current Linux kernel only supports 2GB.  The i386 BIGMEM patch doesn't
</EM><BR>
<EM>&gt; &gt; appear to address our problem either.  Is anyone working on native support
</EM><BR>
<EM>&gt; &gt; for big memory on Alphas?
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Yes, I am working on patches that will support more than 2GB of memory, but
</EM><BR>
<EM>&gt; only for RAWHIDE and all the EV6-based machines, nothing else. I expect to
</EM><BR>
<EM>&gt; have something available for public consumption soon after official 2.2.14
</EM><BR>
<EM>&gt; is released.
</EM><BR>
<P>This would be a real boon for us.  There seems to be considerable
<BR>
confusion about &gt; 2GB RAM support on Alphas - lots of folks blindly
<BR>
asserting that it has always worked for all alphas, while other folks
<BR>
insist you have to buy a &quot;real&quot; server from Compaq for this to work.  Do
<BR>
you know of a definitive reference (other than the kernel source) for
<BR>
answers to this sort of question?
<BR>
<P><EM>&gt; &gt; On a related note, I recently tried compiling a 2.3.26 kernel hoping it
</EM><BR>
<EM>&gt; &gt; might fix the spinlock problems, but it failed with many errors in
</EM><BR>
<EM>&gt; &gt; /usr/src/linux/mm/memory.c
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Join the crowd... :-\
</EM><BR>
<P>Yeah, I've seen several messages on this topic since joining the alpha
<BR>
lists...
<BR>
<P>Thanks again for your thorough answers - they really helped.
<BR>
<P>&nbsp;- C
<BR>
<P><P><PRE>
-- 
To unsubscribe: send e-mail to axp-list-request@redhat.com with
'unsubscribe' as the subject.  Do not send it to axp-list@redhat.com
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0523.html">Blake L. Carlson: "Re: Gtk+ - does it work on Alpha?"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0521.html">Jay.Estabrook@digital.com: "Re: 21264 Alpha stuck spinlocks and memory woes"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0521.html">Jay.Estabrook@digital.com: "Re: 21264 Alpha stuck spinlocks and memory woes"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0553.html">Paul Jakma: "Re: 21264 Alpha stuck spinlocks and memory woes"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0521.html">Chance Reschke: "Re: 21264 Alpha stuck spinlocks and memory woes"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0522.html">Chance Reschke: "Re: 21264 Alpha stuck spinlocks and memory woes"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a23</A> 
: <EM>Mon Nov 15 1999 - 10:34:14 AKST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
