<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>AXP-List Hypermail Archive: Re: Links (web browser)</TITLE>
<META NAME="Author" CONTENT="Michal Jaegermann (michal@ellpspace.math.ualberta.ca)">
<META NAME="Subject" CONTENT="Re: Links (web browser)">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: Links (web browser)</H1>
<HR>
<P>
<!-- received="Sat Nov 27 14:50:35 1999" -->
<!-- isoreceived="19991127235035" -->
<!-- sent="Sat, 27 Nov 1999 16:50:15 -0700 (MST)" -->
<!-- isosent="19991127235015" -->
<!-- name="Michal Jaegermann" -->
<!-- email="michal@ellpspace.math.ualberta.ca" -->
<!-- subject="Re: Links (web browser)" -->
<!-- id="199911272350.QAA12032@ellpspace.math.ualberta.ca" -->
<!-- inreplyto="Pine.LNX.4.05_heb2.07.9911261945290.1063-100000@uranus.theophys.kth.se" -->
<STRONG>Subject: </STRONG>Re: Links (web browser)<BR>
<STRONG>From: </STRONG>Michal Jaegermann (<EM>michal@ellpspace.math.ualberta.ca</EM>)<BR>
<STRONG>Date: </STRONG>Sat Nov 27 1999 - 14:50:15 AKST
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#878">[ date ]</A>
<A HREF="index.html#878">[ thread ]</A>
<A HREF="subject.html#878">[ subject ]</A>
<A HREF="author.html#878">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0879.html">Chris Kloiber: "Red Hat Rawhide/Alpha"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0877.html">Uncle George: "Dec's ccc &amp; asm"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0872.html">Jurij Smakov: "Links (web browser)"</A>
<!-- nextthread="start" -->
<LI><STRONG>Reply:</STRONG> <A HREF="0872.html">Michal Jaegermann: "Re: Links (web browser)"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0878.html">Michal Jaegermann: "Re: Links (web browser)"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
</PRE>
<P>
Jurij Smakov wrote:
<BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; It is called &quot;links&quot; and home page is 
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; <A HREF="http://artax.karlin.mff.cuni.cz/~mikulas/vyplody/links/">http://artax.karlin.mff.cuni.cz/~mikulas/vyplody/links/</A>
</EM><BR>
<EM>&gt;
</EM><BR>
...
<BR>
<EM>&gt; Unfortunately, it does not run on Alpha &quot;out-of-the-box&quot; (it compiles ok,
</EM><BR>
<EM>&gt; but segfaults),
</EM><BR>
<P>No, actually &quot;compiles ok&quot; is very far from beeing the case.  If you try
<BR>
to compile with -Wall (which you always should as an obvious thing to
<BR>
do) then, among multiple other things you will see these:
<BR>
<P>gcc -DHAVE_CONFIG_H -I. -I. -I.     -O2 -g -Wall -c html.c
<BR>
html.c: In function `new_menu_item':
<BR>
html.c:1151: warning: cast to pointer from integer of different size
<BR>
html.c: In function `menu_labels':
<BR>
html.c:1211: warning: cast from pointer to integer of different size
<BR>
html.c: In function `menu_contains':
<BR>
html.c:1218: warning: cast from pointer to integer of different size
<BR>
gcc -DHAVE_CONFIG_H -I. -I. -I.     -O2 -g -Wall -c html_r.c
<BR>
html_r.c: In function `html_special':
<BR>
html_r.c:548: warning: cast to pointer from integer of different size
<BR>
gcc -DHAVE_CONFIG_H -I. -I. -I.     -O2 -g -Wall -c menu.c
<BR>
menu.c: In function `display_codepage':
<BR>
menu.c:244: warning: cast from pointer to integer of different size
<BR>
menu.c: In function `assumed_codepage':
<BR>
menu.c:252: warning: cast from pointer to integer of different size
<BR>
menu.c: In function `charset_list':
<BR>
menu.c:273: warning: cast to pointer from integer of different size
<BR>
session.c: In function `add_time_to_str':
<BR>
session.c:38: warning: int format, different type arg (arg 3)
<BR>
session.c:39: warning: int format, different type arg (arg 3)
<BR>
session.c:39: warning: int format, different type arg (arg 4)
<BR>
session.c:40: warning: int format, different type arg (arg 3)
<BR>
session.c:41: warning: int format, different type arg (arg 3)
<BR>
session.c: In function `do_move':
<BR>
session.c: In function `win_func':
<BR>
session.c:1082: warning: cast to pointer from integer of different size
<BR>
session.c:1082: warning: cast to pointer from integer of different size
<BR>
gcc -DHAVE_CONFIG_H -I. -I. -I.     -O2 -g -Wall -c terminal.c
<BR>
terminal.c: In function `in_term':
<BR>
terminal.c:278: warning: cast from pointer to integer of different size
<BR>
terminal.c: In function `close_handle':
<BR>
terminal.c:556: warning: cast from pointer to integer of different size
<BR>
terminal.c: In function `unblock_terminal':
<BR>
terminal.c:563: warning: cast to pointer from integer of different size
<BR>
terminal.c: In function `exec_on_terminal':
<BR>
terminal.c:596: warning: cast to pointer from integer of different size
<BR>
gcc -DHAVE_CONFIG_H -I. -I. -I.     -O2 -g -Wall -c types.c
<BR>
types.c: In function `add_ct_fn':
<BR>
types.c: In function `really_del_ct':
<BR>
types.c:187: warning: cast from pointer to integer of different size
<BR>
types.c: In function `menu_del_ct':
<BR>
types.c:199: warning: cast from pointer to integer of different size
<BR>
types.c: In function `menu_add_ct':
<BR>
types.c:217: warning: cast from pointer to integer of different size
<BR>
types.c: In function `add_ext_fn':
<BR>
types.c: In function `really_del_ext':
<BR>
types.c:362: warning: cast from pointer to integer of different size
<BR>
types.c: In function `menu_del_ext':
<BR>
types.c:374: warning: cast from pointer to integer of different size
<BR>
types.c: In function `menu_add_ext':
<BR>
types.c:390: warning: cast from pointer to integer of different size
<BR>
gcc -DHAVE_CONFIG_H -I. -I. -I.     -O2 -g -Wall -c url.c
<BR>
gcc -DHAVE_CONFIG_H -I. -I. -I.     -O2 -g -Wall -c view.c
<BR>
view.c: In function `selected_item':
<BR>
view.c:1220: warning: cast from pointer to integer of different size
<BR>
<P>You can possibly get away with the stuff in html.c.  Parts in session.c,
<BR>
terminal.c and types.c are obviously quite broken - even on Intel
<BR>
regardless of the fact that there you can pretend that nothing happened.
<BR>
The author is, at least partially, aware of this as you can see a
<BR>
comment like:
<BR>
<P>&nbsp;/* !!! FIXME: doesn't work on 64b machines */
<BR>
<P>in terminal.c.  Also various structures are laid out and used in such
<BR>
manner that one gets tons of an 'unaligned access' even before the
<BR>
program really started.
<BR>
<P>The bomb on a startup is caused directly by a 
<BR>
<P>struct event {
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int ev;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int x;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int y;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int b;
<BR>
};
<BR>
<P>defined like that in links.h.  In a function 'win_func()' from session.c
<BR>
an attempted use (shudder!) is as follows:
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_session_info(win-&gt;term-&gt;fdin, ses,
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(char *)ev-&gt;b + sizeof(int),
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*(int *)ev-&gt;b))
<BR>
where 'ev' is a pointer to something of a 'struct event' type.
<BR>
Dereferencing a pointer which was first cut to 'int' is not going to
<BR>
fly, I am afraid, and one gets a well deserved SIGSEGV.
<BR>
<P>The program is likely easier to fix than Mozilla :-) but it is highly
<BR>
unfortunate that even nowadays people are writing a new code in such
<BR>
sloppy manner.  &quot;Porting to Alpha&quot; should be understood as an overpolite
<BR>
translation of &quot;fixing nasty bugs&quot; (like using &quot;%d&quot; format in sprintf to
<BR>
store in variables which were even __declared__ as long).  It may be not
<BR>
as easy to fix as you may think; interdependencies can be quite
<BR>
convoluted and catching all function calls where you can loose
<BR>
half of your pointer and misalign a stack can be quite a task after
<BR>
not so small chunk of code was already written.
<BR>
<P>&nbsp;&nbsp;Michal
<BR>
<P><PRE>
-- 
To unsubscribe: send e-mail to axp-list-request@redhat.com with
'unsubscribe' as the subject.  Do not send it to axp-list@redhat.com
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0879.html">Chris Kloiber: "Red Hat Rawhide/Alpha"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0877.html">Uncle George: "Dec's ccc &amp; asm"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0872.html">Jurij Smakov: "Links (web browser)"</A>
<!-- nextthread="start" -->
<LI><STRONG>Reply:</STRONG> <A HREF="0872.html">Michal Jaegermann: "Re: Links (web browser)"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0878.html">Michal Jaegermann: "Re: Links (web browser)"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a23</A> 
: <EM>Sat Nov 27 1999 - 14:50:37 AKST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
