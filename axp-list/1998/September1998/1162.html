<!-- received="Fri Oct  2 16:36:40 1998 " -->
<!-- sent="Fri, 02 Oct 1998 15:30:02 -0400" -->
<!-- name="Craig P Prescott" -->
<!-- email="prescott@phys.ufl.edu" -->
<!-- subject="runaway klogd/syslogd happening now" -->
<!-- id="199810021930.PAA08906@neptune.phys.ufl.edu" -->
<!-- inreplyto="ео	@ео	@request@redhat.com with
(" -->
<HTML><HEAD><META NAME="htdig-email" CONTENT="webmaster@redhat.com"><TITLE>runaway klogd/syslogd happening now</TITLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#ececec"  LINK="#3333cc" VLINK="#666666"><h2>runaway klogd/syslogd happening now</h2>

<b>Craig P Prescott</b> (<a href="mailto:prescott@phys.ufl.edu"><i>prescott@phys.ufl.edu</i></a>)<br>
<i>Fri, 02 Oct 1998 15:30:02 -0400</i>
<p>
<ul>
<li> <b>Messages sorted by:</b> <a href="date.html#1162">[ date ]</a><a href="index.html#1162">[ thread ]</a><a href="subject.html#1162">[ subject ]</a><a href="author.html#1162">[ author ]</a>
<!-- next="start" -->
<li> <b>Next message:</b> <a href="1163.html">Adam C. Powell, IV: "Re: top/gtop for RedHat Alpha 5.1?"</a>
<li> <b>Previous message:</b> <a href="1161.html">Greg Lindahl: "Re: top/gtop for RedHat Alpha 5.1?"</a>
<!-- nextthread="start" -->
<li> <b>Next in thread:</b> <a href="1172.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1172.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1177.html">Craig P Prescott: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1178.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1184.html">Shane Steven Sturrock: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1203.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1204.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1211.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1214.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1221.html">Craig P Prescott: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1248.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1250.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1255.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1270.html">Craig P Prescott: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1272.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1292.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1293.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1305.html">Quant-X Alpha Linux Support: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1328.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<!-- reply="end" -->
</ul>
<!-- body="start" -->
Hi, all;<br>
<p>
We have 13 533 MHz 164LXs in a producing high energy physics<br>
simulation data.  Two of these nodes are presently suffering from the<br>
"klogd and syslogd are eating all the CPU" problem, so I thought I<br>
would post and ask the readers of this list if there is any more<br>
information I can provide regarding this problem, in the hope that<br>
additional info can help to solve this problem once and for all.<br>
Barring any responses, at least this can be a data point.  I will not<br>
restart the logging daemons on these boxes for at least a few hours to<br>
give time for replies from the group.<br>
<p>
Enclosed below is some info which may be helpful.  These are 5.0 boxes<br>
running kernel 2.0.32 with patches.  I know the kernel version is<br>
ancient...  Microway set these boxes up a bit weird when we purchased<br>
them, IMHO - I'll be installing 5.1 from scratch during the next down<br>
time.<br>
<p>
This particular problem has never happened here when the nodes are<br>
idling (i.e., not running the big simulation jobs).  This means CPU<br>
load and network access.  <br>
<p>
We've been running since May or so, and we switched from hard mounting<br>
all the disks to using amd during the first few weeks of running.  I<br>
mention this since I don't recall us having this problem before we<br>
went to using automount.  I know this is a shot in the dark, but do<br>
the others who suffer from this problem also use amd?  amd -v output<br>
is at the end of this note.<br>
<p>
Anyway, if I can provide any more useful info, please tell me what to<br>
do.  Also, as I have never used strace before, any pointers on how to<br>
get the most useful info out of it would be appreciated.<br>
<p>
Many thanks in advance,<br>
Craig<br>
<pre>
---
Craig P Prescott                              (352) 846-3145 (Phone)
2011 New Physics Building                     (352) 392-8863 (Fax)
University of Florida, Gainesville, FL 32611  <a href="mailto:prescott@phys.ufl.edu">prescott@phys.ufl.edu</a>
<p>
<p>
[root@helix01 /root]# uname -a
Linux helix01 2.0.32 #1 Mon Mar 23 12:52:55 EST 1998 alpha unknown
[root@helix01 /root]# cat /etc/redhat-release 
release 5.0 (Hurricane)
[root@helix01 /root]# cat /proc/sys/kernel/file-max
1024
[root@helix01 /root]# cat /proc/sys/kernel/file-nr
320
[root@helix01 /root]# cat /proc/sys/kernel/inode-max 
3072
[root@helix01 /root]# cat /proc/sys/kernel/inode-nr 
920     665
[root@helix01 /root]# grep initdefault /etc/inittab | grep id
id:3:initdefault:
[root@helix01 /root]# ls /etc/rc.d/rc3.d/
K10named        K40snmpd        S30syslog       S60lpd          S80sendmail
K15gpm          K55routed       S40atd          S60nfs          S99local
K15httpd        K98kerneld      S40crond        S60nfs.rpmsave
K15sound        S10network      S40portmap      S60rwhod
K20rusersd      S15nfsfs        S50inet         S72amd
K35smb          S20random       S55ypbind       S75keytable
[root@helix01 /root]# strace -V
strace -- version 3.1
[root@helix01 /root]# top
  2:23pm  up 4 days,  4:23,  3 users,  load average: 2.94, 2.61, 2.60
47 processes: 41 sleeping, 5 running, 1 zombie, 0 stopped
CPU states: 72.4% user, 27.4% system,  0.0% nice,  0.4% idle
Mem:  125760K av, 124312K used,   1448K free,  31536K shrd,   5728K buff
Swap: 523640K av,   1568K used, 522072K free                 66960K cached
<p>
  PID USER     PRI  NI  SIZE  RSS SHARE STAT  LIB %CPU %MEM   TIME COMMAND
  165 root      19   0   632  608   488 R     560 26.0  0.2 469:31 klogd
  156 root      19   0   920  800   696 S     728 25.7  0.3 461:07 syslogd
15116 cleomc    20   0 42376  41M  5416 R     35M 23.6 16.8   1:05 cleog
  635 root       4   0  2688 2536  1944 S    2320 14.5  1.0   0:06 xterm
  254 root       3   0   944  928   640 R     816  9.1  0.3 163:38 rpc.nfsd
15150 root       1   0  1072 1072   816 R    1008  0.7  0.4   0:00 top
    1 root       0   0   600  520   472 S     472  0.0  0.2   0:17 init
    2 root       0   0     0    0     0 SW      0  0.0  0.0   0:16 kflushd
    3 root      17  17     0    0     0 SWN     0  0.0  0.0   0:00 kswapd
    4 root       0   0     0    0     0 SW      0  0.0  0.0   0:00 nfsiod
    5 root       0   0     0    0     0 SW      0  0.0  0.0   0:00 nfsiod
    6 root       0   0     0    0     0 SW      0  0.0  0.0   0:00 nfsiod
    7 root       0   0     0    0     0 SW      0  0.0  0.0   0:00 nfsiod
  650 cleomc     0   0  1672 1552  1160 S    1032  0.0  0.6   0:00 tcsh
  341 root       0   0   480  384   376 S     376  0.0  0.1   0:00 mingetty
  342 root       0   0   480  384   376 S     368  0.0  0.1   0:00 mingetty
   27 root       0   0   528  456   416 S     424  0.0  0.1   0:00 kerneld
<p>
/var/log/messages containts the standard slew of complaints:
<p>
Oct  2 14:21:57 helix01 kernel: Cannot read proc file system: 9 - Bad file descriptor.
Oct  2 14:22:27 helix01 last message repeated 155510 times
Oct  2 14:23:28 helix01 last message repeated 351761 times
Oct  2 14:24:30 helix01 last message repeated 262479 times
Oct  2 14:25:30 helix01 last message repeated 355391 times
Oct  2 14:26:31 helix01 last message repeated 377503 times
Oct  2 14:27:32 helix01 last message repeated 373464 times
Oct  2 14:28:33 helix01 last message repeated 356431 times
<p>
and so on.
<p>
I "strace -c"'d the klogd and syslogd PIDs.  Here is what they spit
out:
<p>
klogd:
<p>
write(1, "&lt;3&gt;Oct  2 14:29:51 kernel: Canno"..., 82) = 82
read(15913, 0x120107f84, 4096)          = -1 EBADF (Bad file descriptor)
gettimeofday({907352991, 883789}, NULL) = 0
write(1, "&lt;3&gt;Oct  2 14:29:51 kernel: Canno"..., 82) = 82
read(15913, 0x120107f84, 4096)          = -1 EBADF (Bad file descriptor)
gettimeofday({907352991, 886719}, NULL) = 0
<p>
etc., over and over again.  The return value of the write is always
82, and the read is always -1 EBADF.
<p>
syslogd:
<p>
gettimeofday({907353054, 104492}, NULL) = 0
gettimeofday({907353054, 104492}, NULL) = 0
gettimeofday({907353054, 105469}, NULL) = 0
gettimeofday({907353054, 105469}, NULL) = 0
select(1024, [0 3 8 9 10 11 12 13 14], NULL, NULL, NULL) = 1 (in [3])
read(3, "not read proc file system: 9 - B"..., 1024) = 1024
gettimeofday({907353054, 115235}, NULL) = 0
gettimeofday({907353054, 115235}, NULL) = 0
gettimeofday({907353054, 115235}, NULL) = 0
gettimeofday({907353054, 115235}, NULL) = 0
gettimeofday({907353054, 115235}, NULL) = 0
gettimeofday({907353054, 116211}, NULL) = 0
gettimeofday({907353054, 116211}, NULL) = 0
gettimeofday({907353054, 116211}, NULL) = 0
gettimeofday({907353054, 116211}, NULL) = 0
gettimeofday({907353054, 116211}, NULL) = 0
gettimeofday({907353054, 116211}, NULL) = 0
gettimeofday({907353054, 117188}, NULL) = 0
select(1024, [0 3 8 9 10 11 12 13 14], NULL, NULL, NULL) = 1 (in [3])
read(3, "descriptor.\0&lt;3&gt;Oct  2 14:30:54 "..., 1024) = 1024
gettimeofday({907353054, 118164}, NULL) = 0
gettimeofday({907353054, 118164}, NULL) = 0
<p>
etc., over and over again.  There are usually 12 (though sometimes 13)
gettimeofday messages between every select and read.
<p>
Not too surprising, I guess...
<p>
[root@helix01 /root]# amd -v
Copyright (c) 1997-1998 Erez Zadok
Copyright (c) 1990 Jan-Simon Pendry
Copyright (c) 1990 Imperial College of Science, Technology &amp; Medicine
Copyright (c) 1990 The Regents of the University of California.
am-utils version 6.0a16 (build 1).
Built by <a href="mailto:root@spacely.redhat.com">root@spacely.redhat.com</a> on date Tue May  5 20:11:27 EDT 1998.
cpu=alphaev5 (little-endian), arch=alpha, karch=alpha.
full_os=linux, os=linux, osver=2.0.30, vendor=unknown.
Map support for: root, passwd, union, ndbm, file, error.
AMFS: nfs, link, nfsx, nfsl, host, linkx, program, union, inherit, 
      ufs, cdfs, pcfs, auto, direct, toplvl, error.
FS: isofs, nfs, vfat, ext2.
Network: wire="npb2-net.phys.ufl.edu" (netnumber=128.227.89).
<p>
<pre>
-- 
To unsubscribe: send e-mail to <a href="mailto:axp-list-request@redhat.com">axp-list-request@redhat.com</a> with
'unsubscribe' as the subject.  Do not send it to <a href="mailto:axp-list@redhat.com">axp-list@redhat.com</a>
</pre>
<!-- body="end" -->
<p>
<ul>
<!-- next="start" -->
<li> <b>Next message:</b> <a href="1163.html">Adam C. Powell, IV: "Re: top/gtop for RedHat Alpha 5.1?"</a>
<li> <b>Previous message:</b> <a href="1161.html">Greg Lindahl: "Re: top/gtop for RedHat Alpha 5.1?"</a>
<!-- nextthread="start" -->
<li> <b>Next in thread:</b> <a href="1172.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1172.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1177.html">Craig P Prescott: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1178.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1184.html">Shane Steven Sturrock: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1203.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1204.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1211.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1214.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1221.html">Craig P Prescott: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1248.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1250.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1255.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1270.html">Craig P Prescott: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1272.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1292.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1293.html">Greg Lindahl: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1305.html">Quant-X Alpha Linux Support: "Re: runaway klogd/syslogd happening now"</a>
<li> <b>Maybe reply:</b> <a href="1328.html">Uncle George: "Re: runaway klogd/syslogd happening now"</a>
<!-- reply="end" -->
</ul>
<br clear=all>
<hr>
<center>
<a href="mailto:webmaster@redhat.com"   target="">Feedback</a> | 
<a href="http://www.redhat.com/products/"   target="">Store</a> | 
<a href="http://www.redhat.com/news/"   target="">News</a> | 
<a href="http://www.redhat.com/support/"   target="">Support</a> | 
<a href="http://www.redhat.com/support/docs/errata.html"   target="">Product Errata</a> | 
<a href="http://www.redhat.com/redhat/"   target="">About Us</a> | 
<a href="http://www.redhat.com/linux-info/"   target="">Linux Info</a> | 
<a href="http://www.redhat.com/search/"   target="">Search</a> | 
<a href="http://www.redhat.com/jumplist.phtml"   target="">JumpWords</a>
<br>
<a href="http://www.redhat.com/cgi-bin/frames.phtml?fr=n"  _top target="_top">No Frames</a> | 
<a href="http://www.redhat.com/cgi-bin/frames.phtml?fr=y"  _top target="_top">Show Frames</a>
</center>
<p align=center>
Copyright &copy; 1995-1997 Red Hat Software. <a href="http://www.redhat.com/redhat/website.html#legal"   target="">Legal notices</a>
</p>
</BODY></HTML>
