<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>axp-list: Re: Unable to load interpreter // VM thrashing or har</TITLE>
<META NAME="Author" CONTENT="Stefan Boresch (stefan@mdy.univie.ac.at)">
<META NAME="Subject" CONTENT="Re: Unable to load interpreter // VM thrashing or hardware ???">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: Unable to load interpreter // VM thrashing or hardware ???</H1>
<HR>
<P>
<!-- received="Tue Dec 01 17:26:51 1998 PST" -->
<!-- sent="Tue, 1 Dec 1998 18:26:20 +0100 (CET)" -->
<!-- name="Stefan Boresch" -->
<!-- email="stefan@mdy.univie.ac.at" -->
<!-- subject="Re: Unable to load interpreter // VM thrashing or hardware ???" -->
<!-- id="199812011726.SAA30844@beta.mdy.univie.ac.at" -->
<!-- inreplyto="19981130111334.G21829@arginine.umdnj.edu" -->
<STRONG>Stefan Boresch</STRONG> (<A HREF="mailto:stefan@mdy.univie.ac.at?subject=Re:%20Unable%20to%20load%20interpreter%20//%20VM%20thrashing%20or%20hardware%20???"><EM>stefan@mdy.univie.ac.at</EM></A>)<BR>
<EM>Tue, 1 Dec 1998 18:26:20 +0100 (CET)</EM>
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#18">[ date ]</A>
<A HREF="index.html#18">[ thread ]</A>
<A HREF="subject.html#18">[ subject ]</A>
<A HREF="author.html#18">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0019.html">Maurice Hilarius: "RE: Is XL300 or EBP41-AN any good?"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0017.html">Maciej W. Rozycki: "Re: glibc 2.1"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0004.html">B. James Phillippe: "Re: glibc 2.1"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0020.html">Bob McElrath: "Re: Unable to load interpreter // VM thrashing or hardware ???"</A>
</UL>
<HR>
<!-- body="start" -->
<P>
I hope that I am not going on everyone's nerves, but the sudden
<BR>
instabilities of my two Alpha LXs frustrate me. I thought that I
<BR>
have yet another hardware problem, but now I start to doubt this.
<BR>
And from some posts to the initial thread, it seems that I am
<BR>
not the only one having these problems.
<BR>
<P>First, thanks for the replies received so far; at least, I understand
<BR>
now that the error message indicates insufficient
<BR>
memory.  However, I don't understand how the VM system gets in
<BR>
this state, so I'd like to discern between possible hardware and
<BR>
software reasons.  Some observations:
<BR>
<P>(1) The problem (reproducible for me with the code given at the end
<BR>
of this mail) shows up with both the RH 5.1 provided milo and 2.0.35
<BR>
source, as well as with the Oct 10, 1998 milo, pristine 2.0.35 sources
<BR>
plus the alpha-2.0.35-0.2 patches by Jay.
<BR>
<P>(2) The problem appears with the default /proc/sys/kernel/{file-max,
<BR>
inode-max}, as well as with file-max=2048 and inode-max=8192.  Further,
<BR>
why would that affect anything with respect to 
<BR>
<P>(3) The old panacea of setenv MEMORY_SIZE 252 doesn't help either
<BR>
<P>(4) Watching a bit with free, shows an interesting pattern:  For
<BR>
several iterations in the test (4-5), the free amount of virtual
<BR>
memory is where I expect it to be, well &gt; 100MB (for my machine,
<BR>
details follow with the source code). Suddenly, in the fifth or sixth
<BR>
iteration, the virtual memory falls rapidly to 0; obviously, this
<BR>
is when the problem occurs.
<BR>
<P>(5) The same testcase (adjusted for memory sizes) runs for hours on
<BR>
both an UX(!) (kernel compiled from pristine 2.0.35 plus alpha-patches
<BR>
plus the 2.0.35-0.1 alpha patches by Jay, plus a fairly recent ldmilo
<BR>
+ pal-codes by Jay, plus a larger value of SHMMAX in shmparam.h, some
<BR>
black magic at least at some point necessary for the UX) and an Intel
<BR>
machine after a default RH 5.2 installation.
<BR>
<P>(6) As I said earlier, I suspected initially hardware problems, since one
<BR>
of the afflicted machines had a number of problems in the past.  However, the
<BR>
second machine has been running perfectly for several weeks, only that we
<BR>
now have an application that apparently leads to heavy paging.
<BR>
<P>It would be great if someone were willing to try whether he/she can
<BR>
reproduce the problem on a similar configuration.  For me, the problem
<BR>
shows up within an hour; provided one kills the test-executable by
<BR>
Ctrl-C fairly quickly, the systems recover or can at least be shut
<BR>
down cleanly.
<BR>
<P>My systems are both LX 533MHz, 256MB RAM, 2 x 136512k swap space (I
<BR>
thought on an Alpha with a page size of 8k this was fine?), Adaptec
<BR>
2940U/UW, respectively.  Both run RH 5.1, and normally a kernel 
<BR>
compiled from the RH provided 2.0.35 sources.  I remember hearing
<BR>
rumours that there are definitely problems on large memory machines
<BR>
<EM>&gt;= 512M (both LX/UX); could anyone more knowledgeable comment on
</EM><BR>
those issues?
<BR>
<P>Well, finally, here is the test case (with slight modifications 
<BR>
identical to code from D.Gilbert posted here several months ago):
<BR>
The SIZE variable is chosen for my RAM size, i.e. I enforce 
<BR>
swapping: this same test runs happily with SIZE being set to 240*256*..
<BR>
which on an empty machine seems to fit in RAM.
<BR>
<P>---------------------------------------------------------------------
<BR>
<P>#include &lt;stdio.h&gt;
<BR>
#include &lt;stdlib.h&gt;
<BR>
<P>#define SIZE (260*256*1024*sizeof(int))
<BR>
int main() {
<BR>
&nbsp;&nbsp;volatile int * volatile pl=(int *)malloc(SIZE);
<BR>
<P>&nbsp;&nbsp;int a;
<BR>
<P>&nbsp;&nbsp;int s;
<BR>
&nbsp;&nbsp;
<BR>
&nbsp;&nbsp;int sum1,sum2;
<BR>
<P>&nbsp;&nbsp;printf(&quot;Using %d bytes.\n&quot;,SIZE);
<BR>
&nbsp;&nbsp;for(s=1056;;s++) {
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Filling with seed of s=0x%x \n&quot;,s);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;srandom(s);
<BR>
sum1=0;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;for(a=0;a&lt;(SIZE/sizeof(int));a++) {
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int tmp1=random();
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum1+=tmp1;
<BR>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pl[a]=tmp1;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;};
<BR>
<P>&nbsp;&nbsp;&nbsp;&nbsp;srandom(s);
<BR>
<P>&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Testing with seed of s=0x%x \n&quot;,s);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;for(a=0,sum2=0;a&lt;(SIZE/sizeof(int));a++) {
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int tmp1=random();
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int tmp2=pl[a];
<BR>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum2+=tmp1;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (tmp1!=tmp2) {
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fprintf(stderr,&quot;MISMATCH ERROR! at a=0x%x (random=0x%x array=0x%x
<BR>
reread=0x%x seed=
<BR>
0x%x)\n&quot;,a,tmp1,tmp2,pl[a],s);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;};
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Completed pass with seed of s=0x%x sum1=0x%x
<BR>
sum2=0x%x\n&quot;,s,sum1,sum2);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if (sum1!=sum2) {
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Internal inconsistency! Sums differ! sum1=0x%x
<BR>
sum2=0x%x\n&quot;,sum1,sum2);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(2);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;};
<BR>
&nbsp;&nbsp;};
<BR>
};
<BR>
<P><P><PRE>
-- 
To unsubscribe: send e-mail to <A HREF="mailto:axp-list-request@redhat.com?subject=Re:%20Unable%20to%20load%20interpreter%20//%20VM%20thrashing%20or%20hardware%20???">axp-list-request@redhat.com</A> with
'unsubscribe' as the subject.  Do not send it to <A HREF="mailto:axp-list@redhat.com?subject=Re:%20Unable%20to%20load%20interpreter%20//%20VM%20thrashing%20or%20hardware%20???">axp-list@redhat.com</A>
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0019.html">Maurice Hilarius: "RE: Is XL300 or EBP41-AN any good?"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0017.html">Maciej W. Rozycki: "Re: glibc 2.1"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0004.html">B. James Phillippe: "Re: glibc 2.1"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0020.html">Bob McElrath: "Re: Unable to load interpreter // VM thrashing or hardware ???"</A>
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.landfield.com/hypermail/">hypermail 2.0b3</A> 
on <EM>Tue Dec 01 1998 - 15:17:15 PST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
