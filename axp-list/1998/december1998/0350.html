<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>axp-list: Re: How do I find/fix unaligned accesses?</TITLE>
<META NAME="Author" CONTENT="Christian Groessler (cpg@aladdin.de)">
<META NAME="Subject" CONTENT="Re: How do I find/fix unaligned accesses?">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: How do I find/fix unaligned accesses?</H1>
<HR>
<P>
<!-- received="Tue Dec 08 22:57:30 1998 PST" -->
<!-- sent="Tue, 8 Dec 1998 22:13:08 +0100" -->
<!-- name="Christian Groessler" -->
<!-- email="cpg@aladdin.de" -->
<!-- subject="Re: How do I find/fix unaligned accesses?" -->
<!-- id="412566D4.0074F6BB.00@saturn.aladdin.de" -->
<!-- inreplyto="How do I find/fix unaligned accesses?" -->
<STRONG>Christian Groessler</STRONG> (<A HREF="mailto:cpg@aladdin.de?subject=Re:%20How%20do%20I%20find/fix%20unaligned%20accesses?"><EM>cpg@aladdin.de</EM></A>)<BR>
<EM>Tue, 8 Dec 1998 22:13:08 +0100</EM>
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#350">[ date ]</A>
<A HREF="index.html#350">[ thread ]</A>
<A HREF="subject.html#350">[ subject ]</A>
<A HREF="author.html#350">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Previous message:</STRONG> <A HREF="0349.html">Chris Albertson: "Re: CD-wrtiers"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0343.html">Randy Carpenter: "Re: CD-wrtiers"</A>
<!-- nextthread="start" -->
</UL>
<HR>
<!-- body="start" -->
<P>
<EM>&gt;Isn't there a syscall to stop kernel unaligned trap fixup?
</EM><BR>
<P>The following code I've got from this mail list iirc, but cannot
<BR>
remember from who it was. Sorry.
<BR>
<P>This program will spawn a subshell, in which unaligned accessed
<BR>
generate a bus fault.
<BR>
<P>------------
<BR>
/* 28-May-98, chris */
<BR>
<P><P>#ifndef __linux__
<BR>
#include &lt;sys/sysinfo.h&gt;
<BR>
#else
<BR>
#include &lt;asm/sysinfo.h&gt;
<BR>
#include &lt;asm/unistd.h&gt;
<BR>
<P>static int setsysinfo(unsigned long op, void *buffer, unsigned long size,
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int *start, void *arg, unsigned long flag)
<BR>
{
<BR>
&nbsp;&nbsp;syscall(__NR_osf_setsysinfo, op, buffer, size, start, arg, flag);
<BR>
}
<BR>
#endif
<BR>
<P>void trap_unaligned(void)
<BR>
{
<BR>
&nbsp;&nbsp;unsigned int buf[2];
<BR>
&nbsp;&nbsp;buf[0] = SSIN_UACPROC;
<BR>
&nbsp;&nbsp;buf[1] = UAC_SIGBUS | UAC_NOPRINT;
<BR>
&nbsp;&nbsp;setsysinfo(SSI_NVPAIRS, buf, 1, 0, 0, 0);
<BR>
}
<BR>
<P>int main(int ac)
<BR>
{
<BR>
&nbsp;&nbsp;trap_unaligned();
<BR>
&nbsp;&nbsp;printf(&quot;creating subshell with SIGBUS setting!\n&quot;);
<BR>
&nbsp;&nbsp;execl(&quot;/bin/bash&quot;,&quot;/bin/bash&quot;,(char *)0);
<BR>
&nbsp;&nbsp;return(0); /* not reached */
<BR>
}
<BR>
------------
<BR>
<P><P><P><PRE>
-- 
To unsubscribe: send e-mail to <A HREF="mailto:axp-list-request@redhat.com?subject=Re:%20How%20do%20I%20find/fix%20unaligned%20accesses?">axp-list-request@redhat.com</A> with
'unsubscribe' as the subject.  Do not send it to <A HREF="mailto:axp-list@redhat.com?subject=Re:%20How%20do%20I%20find/fix%20unaligned%20accesses?">axp-list@redhat.com</A>
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Previous message:</STRONG> <A HREF="0349.html">Chris Albertson: "Re: CD-wrtiers"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0343.html">Randy Carpenter: "Re: CD-wrtiers"</A>
<!-- nextthread="start" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.landfield.com/hypermail/">hypermail 2.0b3</A> 
on <EM>Tue Dec 08 1998 - 15:00:29 PST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
