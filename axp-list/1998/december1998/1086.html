<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>axp-list: Re: ES1370 and 2.1.13[012] booting problems on Ruffian</TITLE>
<META NAME="Author" CONTENT="Jay.Estabrook@digital.com (Jay.Estabrook@digital.com)">
<META NAME="Subject" CONTENT="Re: ES1370 and 2.1.13[012] booting problems on Ruffian">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: ES1370 and 2.1.13[012] booting problems on Ruffian</H1>
<HR>
<P>
<!-- received="Sun Dec 27 05:35:59 1998 PST" -->
<!-- sent="Sun, 27 Dec 1998 00:33:19 -0500" -->
<!-- name="Jay.Estabrook@digital.com" -->
<!-- email="Jay.Estabrook@digital.com" -->
<!-- subject="Re: ES1370 and 2.1.13[012] booting problems on Ruffian" -->
<!-- id="199812270533.AAA02569@alpha1.estabrook.org" -->
<!-- inreplyto="Pine.LNX.4.05.9812270531230.441-100000@Noustoulight.InsomNet.fr" -->
<A HREF="mailto:Jay.Estabrook@digital.com?subject=Re:%20ES1370%20and%202.1.13[012]%20booting%20problems%20on%20Ruffian"><EM>Jay.Estabrook@digital.com</EM></A><BR>
<EM>Sun, 27 Dec 1998 00:33:19 -0500</EM>
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#1086">[ date ]</A>
<A HREF="index.html#1086">[ thread ]</A>
<A HREF="subject.html#1086">[ subject ]</A>
<A HREF="author.html#1086">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="1087.html">Jay.Estabrook@digital.com: "Re: LX164 and rpcc"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="1085.html">Larry Snyder: "Multia booting brain farts"</A>
<!-- nextthread="start" -->
</UL>
<HR>
<!-- body="start" -->
<P>
<EM>&gt;&gt;&gt; MoT said:
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; 1) since release 2.1.130, the kernels hangs just after displaying
</EM><BR>
<EM>&gt; &quot;Calibrating loop delay...&quot;. This small patch corrected the problem (it simply
</EM><BR>
<EM>&gt; cancels a modification made between 2.1.129 and 2.1.130):
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; --- arch/alpha/kernel/sys_ruffian-old.c Thu Dec 17 02:42:59 1998
</EM><BR>
<EM>&gt; +++ arch/alpha/kernel/sys_ruffian.c     Fri Dec 18 20:03:55 1998
</EM><BR>
<EM>&gt; @@ -107,7 +107,7 @@
</EM><BR>
<EM>&gt;                         if (j == 7 &amp;&amp; !(inb(0x20) &amp; 0x80)) {
</EM><BR>
<EM>&gt;                                 /* It's only a passive release... */
</EM><BR>
<EM>&gt;                         } else if (j == 0) {
</EM><BR>
<EM>&gt; -                               handle_irq(8, -1, regs); /* fake it */
</EM><BR>
<EM>&gt; +                               timer_interrupt(0, NULL, regs);
</EM><BR>
<EM>&gt;                                 ruffian_ack_irq(0);
</EM><BR>
<EM>&gt;                         } else {
</EM><BR>
<EM>&gt;                                 handle_irq(j, j, regs);
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; It's clearly a Ruffian specific problem since no one else reported it on
</EM><BR>
<EM>&gt; the list.
</EM><BR>
<P>This change will work correctly *ONLY* if you have CONFIG_RTC set; I assume
<BR>
you have selected the &quot;RTC&quot; option during config?
<BR>
<P>I think the change needs to be (referring to arch/alpha/kernel/time.c):
<BR>
<P>#if CONFIG_RTC
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handle_irq(0, -1, regs);
<BR>
#else
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handle_irq(8, -1, regs);
<BR>
#endif
<BR>
<P>in order to work correctly in *both* cases.
<BR>
<P>Thanks for catching this!
<BR>
<P>--Jay++
<BR>
<P>-------------------------------------------------------------------------------
<BR>
&nbsp;&nbsp;American Non Sequitur Society: we don't make sense, but we do like pizza...
<BR>
<P>Jay A Estabrook                            Alpha Motherboards - LINUX Project
<BR>
Compaq Computer Corporation                (508) 841-3241 or (DTN) 237-3241
<BR>
334 South Street, Shrewsbury, MA 01545     <A HREF="mailto:Jay.Estabrook@digital.com?subject=Re:%20ES1370%20and%202.1.13[012]%20booting%20problems%20on%20Ruffian">Jay.Estabrook@digital.com</A>
<BR>
-------------------------------------------------------------------------------
<BR>
<P><P><PRE>
-- 
To unsubscribe: send e-mail to <A HREF="mailto:axp-list-request@redhat.com?subject=Re:%20ES1370%20and%202.1.13[012]%20booting%20problems%20on%20Ruffian">axp-list-request@redhat.com</A> with
'unsubscribe' as the subject.  Do not send it to <A HREF="mailto:axp-list@redhat.com?subject=Re:%20ES1370%20and%202.1.13[012]%20booting%20problems%20on%20Ruffian">axp-list@redhat.com</A>
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="1087.html">Jay.Estabrook@digital.com: "Re: LX164 and rpcc"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="1085.html">Larry Snyder: "Multia booting brain farts"</A>
<!-- nextthread="start" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.landfield.com/hypermail/">hypermail 2.0b3</A> 
on <EM>Sat Dec 26 1998 - 22:00:13 PST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
