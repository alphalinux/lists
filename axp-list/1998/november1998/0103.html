<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Mailbox: &quot;unimplemented OSF mmap flags 0201&quot;</TITLE>
<META NAME="Author" CONTENT="furio ercolessi (furio@spin.it)">
<META NAME="Subject" CONTENT="&quot;unimplemented OSF mmap flags 0201&quot;">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>&quot;unimplemented OSF mmap flags 0201&quot;</H1>
<HR>
<P>
<!-- received="Mon Nov 16 00:23:35 1998 PST" -->
<!-- sent="Mon, 16 Nov 1998 0:25:20 MET" -->
<!-- name="furio ercolessi" -->
<!-- email="furio@spin.it" -->
<!-- subject="&quot;unimplemented OSF mmap flags 0201&quot;" -->
<!-- id="199811152325.AAA15784@mail.spin.it" -->
<!-- inreplyto="" -->
<STRONG>furio ercolessi</STRONG> (<A HREF="mailto:furio@spin.it?subject=Re:%20&quot;unimplemented%20OSF%20mmap%20flags%200201&quot;"><EM>furio@spin.it</EM></A>)<BR>
<EM>Mon, 16 Nov 1998 0:25:20 MET</EM>
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#103">[ date ]</A>
<A HREF="index.html#103">[ thread ]</A>
<A HREF="subject.html#103">[ subject ]</A>
<A HREF="author.html#103">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0104.html">Randy Carpenter: "Re: Netscape on Alpha Questions"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0102.html">Jeff DeMaagd: "SDL problems..."</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0106.html">furio ercolessi: "Re: &quot;unimplemented OSF mmap flags 0201&quot;"</A>
</UL>
<HR>
<!-- body="start" -->
<P>
I am trying to build sendmail 8.9.1 with Berkeley db 2.5.9 (from
<BR>
SleepyCat) on a stock RH 5.2 system (2.0.35, glibc 2.0.7-29,
<BR>
egcs 1.0.3).
<BR>
<P>It apparently works, but I get messages
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kernel: sendmail: unimplemented OSF mmap flags 0201
<BR>
in /var/log/messages, apparently every time sendmail starts.
<BR>
This does not happen when I use the standard libdb included
<BR>
with glibc.
<BR>
<P>I had a brief email exchange with SleepyCat, and they say
<BR>
that, most likely, Alpha Linux states in some include file 
<BR>
that these flags are supported, while in reality they are not.
<BR>
I found a similar comment in a very old message in the archives:
<BR>
<A HREF="http://archive.redhat.com/axp-list/1996/1996-November/0275.html">http://archive.redhat.com/axp-list/1996/1996-November/0275.html</A>
<BR>
<P>So I made a little research. The offending message comes from function
<BR>
osf_mmap in arch/alpha/kernel/osf_sys.c :
<BR>
[...]
<BR>
if (flags &amp; (MAP_HASSEMAPHORE | MAP_INHERIT | MAP_UNALIGNED))
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printk(&quot;%s: unimplemented OSF mmap flags %04lx\n&quot;, current-&gt;comm, flags);
<BR>
[...]
<BR>
and include/asm-alpha/mman.h contains
<BR>
#define MAP_HASSEMAPHORE 0x0200
<BR>
#define MAP_INHERIT      0x0400
<BR>
#define MAP_UNALIGNED    0x0800
<BR>
so my case (0201) should have to do with MAP_HASSEMAPHORE.
<BR>
The db software indeed checks if this variable is defined
<BR>
(in os/os_map.c), and calls the mmap function with modified
<BR>
flags if it is.  mmap(2) does not mention MAP_HASSEMAPHORE
<BR>
among the supported flags.
<BR>
<P>To summarize, it appears to me that include/asm-alpha/mman.h
<BR>
is indeed faulty in defining things which are not really
<BR>
supported in glibc, thus causing kernel error messages and
<BR>
perhaps misfunctioning applications.
<BR>
If all this is true, include/asm-alpha/mman.h should be
<BR>
modified in the next kernel distributions, removing these
<BR>
three definitions.
<BR>
<P>furio ercolessi
<BR>
Spin 
<BR>
Trieste (Italy)
<BR>
<P><PRE>
-- 
To unsubscribe: send e-mail to <A HREF="mailto:axp-list-request@redhat.com?subject=Re:%20&quot;unimplemented%20OSF%20mmap%20flags%200201&quot;">axp-list-request@redhat.com</A> with
'unsubscribe' as the subject.  Do not send it to <A HREF="mailto:axp-list@redhat.com?subject=Re:%20&quot;unimplemented%20OSF%20mmap%20flags%200201&quot;">axp-list@redhat.com</A>
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0104.html">Randy Carpenter: "Re: Netscape on Alpha Questions"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0102.html">Jeff DeMaagd: "SDL problems..."</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0106.html">furio ercolessi: "Re: &quot;unimplemented OSF mmap flags 0201&quot;"</A>
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.landfield.com/hypermail/">hypermail 2.0b3</A> 
on <EM>Tue Nov 17 1998 - 16:23:39 PST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
