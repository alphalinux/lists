<!-- received="Fri May  9 12:58:50 1997 " -->
<!-- sent="Fri, 9 May 1997 12:54:55 -0400 (EDT)" -->
<!-- name="Geling, Gary" -->
<!-- email="Gary.Geling@dreo.dnd.ca" -->
<!-- subject="metamail - fix?" -->
<!-- id="199705091654.MAA11404@algary.abrdr.dreo.dnd.ca" -->
<!-- inreplyto="ео	@ео	@request@redh" -->
<HTML><HEAD><META NAME="htdig-email" CONTENT="webmaster@redhat.com"><TITLE>metamail - fix?</TITLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#ececec"  LINK="#3333cc" VLINK="#666666"><h2>metamail - fix?</h2>

<b>Geling, Gary</b> (<a href="mailto:Gary.Geling@dreo.dnd.ca"><i>Gary.Geling@dreo.dnd.ca</i></a>)<br>
<i>Fri, 9 May 1997 12:54:55 -0400 (EDT)</i>
<p>
<ul>
<li> <b>Messages sorted by:</b> <a href="date.html#334">[ date ]</a><a href="index.html#334">[ thread ]</a><a href="subject.html#334">[ subject ]</a><a href="author.html#334">[ author ]</a>
<!-- next="start" -->
<li> <b>Next message:</b> <a href="0335.html">Geling, Gary: "OCTAVE port?"</a>
<li> <b>Previous message:</b> <a href="0333.html">Zarmfab Software Development: "Re: log(-1) raises SIGFPE"</a>
<!-- nextthread="start" -->
<!-- reply="end" -->
</ul>
<!-- body="start" -->
Greetings,<br>
<p>
   Regarding metamail 2.7-7 on AXP, RH4.1<br>
<p>
   The current include files for RH4.1 do not handle 'old' stuff<br>
very well.  metamail used the old termio structure and included termio.h.<br>
This file quickly redirected this to termios.h and sys/ioctl.h probably<br>
breaking the FAQ port error of confusing termio with termios.  The only<br>
way to get termio actually defined was to define, before any system includes,<br>
the variable _LOOSE_KERNEL_NAMES.  But this resulted in a NON-working <br>
metamail, (hung on multipart messages, trying to reset the terminal state).<br>
<p>
   Easiest solution: convert all references to termio and TC---A- to<br>
termios and TC---S- respectively.  Seems to work like a charm.<br>
<p>
Included is the diff -u file.<br>
<p>
TTFN<br>
   Gary<br>
<pre>
-- 
--------------------------
Gary W. Geling
Pulsed-Doppler Radar Group (PDR)
Aerospace Radar and Navigation (ARN)
Defence Research Establishment Ottawa (DREO)
WWW: <a href="http://www.dreo.dnd.ca">http://www.dreo.dnd.ca</a>
e-mail: <a href="mailto:Gary.Geling@dreo.dnd.ca">Gary.Geling@dreo.dnd.ca</a>
613-998-2063 FAX 613-990-8906
<p>
<p>
--- metamail.c.orig	Fri May  9 12:27:14 1997
+++ metamail.c	Fri May  9 12:28:45 1997
@@ -48,7 +48,7 @@
 
 #ifndef AMIGA
 #ifdef SYSV
-#include &lt;termio.h&gt;
+#include &lt;termios.h&gt;
 #include &lt;sys/ioctl.h&gt;
 #include &lt;unistd.h&gt;
 #else /* SYSV */
@@ -2378,7 +2378,7 @@
 int HasSavedTtyState=0;
 #if !defined(AMIGA) &amp;&amp; !defined(MSDOS)
 #ifdef SYSV
-static struct termio MyTtyStateIn, MyTtyStateOut;
+static struct termios MyTtyStateIn, MyTtyStateOut;
 #else
 static struct sgttyb MyTtyStateIn, MyTtyStateOut;
 #endif
@@ -2388,8 +2388,8 @@
     /* Bogus -- would like a good portable way to reset the terminal state here */
 #if !defined(AMIGA) &amp;&amp; !defined(MSDOS)
 #ifdef SYSV
-    ioctl(fileno(stdin), TCGETA, &amp;MyTtyStateIn);
-    ioctl(fileno(stdout), TCGETA, &amp;MyTtyStateOut);
+    ioctl(fileno(stdin), TCGETS, &amp;MyTtyStateIn);
+    ioctl(fileno(stdout), TCGETS, &amp;MyTtyStateOut);
 #else
     gtty(fileno(stdin), &amp;MyTtyStateIn);
     gtty(fileno(stdout), &amp;MyTtyStateOut);
@@ -2402,8 +2402,8 @@
 #if !defined(AMIGA) &amp;&amp; !defined(MSDOS)
 #ifdef SYSV
     if (HasSavedTtyState) {
-        ioctl(fileno(stdout), TCSETA, &amp;MyTtyStateOut);
-        ioctl(fileno(stdin), TCSETA, &amp;MyTtyStateIn);
+        ioctl(fileno(stdout), TCSETS, &amp;MyTtyStateOut);
+        ioctl(fileno(stdin), TCSETS, &amp;MyTtyStateIn);
     }
 #else
     if (HasSavedTtyState) {
@@ -2684,14 +2684,14 @@
 StartRawStdin() {
 #if !defined(AMIGA) &amp;&amp; !defined(MSDOS)
 #ifdef SYSV
-    struct termio   orterm, fterm;
-    ioctl(0, TCGETA, &amp;orterm);	/* get current (i.e. cooked) termio */
-    fterm = orterm;		/* get termio to modify */
+    struct termios   orterm, fterm;
+    ioctl(0, TCGETS, &amp;orterm);	/* get current (i.e. cooked) termios */
+    fterm = orterm;		/* get termios to modify */
 
     fterm.c_lflag &amp;= ~ICANON;	/* clear ICANON giving raw mode */
     fterm.c_cc[VMIN] = 1;	/* set MIN char count to 1 */
     fterm.c_cc[VTIME] = 0;	/* set NO time limit */
-    return ioctl(0, TCSETAW, &amp;fterm);	/* modify termio for raw mode */
+    return ioctl(0, TCSETSW, &amp;fterm);	/* modify termios for raw mode */
 #else
     struct sgttyb ts;
     gtty(fileno(stdin), &amp;ts);
<p>
<pre>
--
To unsubscribe: send e-mail to <a href="mailto:axp-list-request@redhat.com">axp-list-request@redhat.com</a> with
'unsubscribe' as the subject.  Do not send it to <a href="mailto:axp-list@redhat.com">axp-list@redhat.com</a>
</pre>
<!-- body="end" -->
<p>
<ul>
<!-- next="start" -->
<li> <b>Next message:</b> <a href="0335.html">Geling, Gary: "OCTAVE port?"</a>
<li> <b>Previous message:</b> <a href="0333.html">Zarmfab Software Development: "Re: log(-1) raises SIGFPE"</a>
<!-- nextthread="start" -->
<!-- reply="end" -->
</ul>
<br clear=all>
<hr>
<center>
<a href="mailto:webmaster@redhat.com"   target="">Feedback</a> | 
<a href="http://www.redhat.com/products/"   target="">Store</a> | 
<a href="http://www.redhat.com/news/"   target="">News</a> | 
<a href="http://www.redhat.com/support/"   target="">Support</a> | 
<a href="http://www.redhat.com/support/docs/errata.html"   target="">Product Errata</a> | 
<a href="http://www.redhat.com/redhat/"   target="">About Us</a> | 
<a href="http://www.redhat.com/linux-info/"   target="">Linux Info</a> | 
<a href="http://www.redhat.com/search/"   target="">Search</a> | 
<a href="http://www.redhat.com/jumplist.phtml"   target="">JumpWords</a>
<br>
<a href="http://www.redhat.com/cgi-bin/frames.phtml?fr=n"  _top target="_top">No Frames</a> | 
<a href="http://www.redhat.com/cgi-bin/frames.phtml?fr=y"  _top target="_top">Show Frames</a>
</center>
<p align=center>
Copyright &copy; 1995-1997 Red Hat Software. <a href="http://www.redhat.com/redhat/website.html#legal"   target="">Legal notices</a>
</p>
</BODY></HTML>
