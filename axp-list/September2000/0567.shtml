<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN"> 
     <HTML> 
     <HEAD> 
     <TITLE>Axp-List Archive</TITLE> 
     <LINK REV="made" HREF="mailto:mailto-address"> 
     <HEAD> 
     <BODY BGCOLOR="#DC9D33" TEXT="#000000" LINK="#DD0000" ALINK="#CC0000" VLINK="#CC0000">
		<CENTER>  <!--#exec cgi="/cgi-bin/banmat1.cgi"--></CENTER>

     <H1 ALIGN=CENTER>Axp-List Archive<BR> a cvtts/s of a denorm -&gt;0.0</H1> 
	
<!-- received="Fri Sep 29 22:00:15 2000" -->
<!-- isoreceived="20000930050015" -->
<!-- sent="Fri, 29 Sep 2000 13:24:03 -0500" -->
<!-- isosent="20000929182403" -->
<!-- name="Uncle George" -->
<!-- email="gatgul@voicenet.com" -->
<!-- subject="a cvtts/s of a denorm -&gt;0.0" -->
<!-- id="39D4DE43.4DF4DCF7@voicenet.com" -->
<STRONG>Subject: </STRONG>a cvtts/s of a denorm ->0.0<BR>
<STRONG>From: </STRONG>Uncle George (<EM>gatgul@voicenet.com</EM>)<BR>
<STRONG>Date: </STRONG>Fri Sep 29 11:24:03 2000
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.shtml#567">[ date ]</A>
<A HREF="index.shtml#567">[ thread ]</A>
<A HREF="subject.shtml#567">[ subject ]</A>
<A HREF="author.shtml#567">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0568.shtml">Jeff Sturm: "Re: gcc"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0566.shtml">David Rysdam: "Re: NFS and Alpha"</A>
<!-- nextthread="start" -->
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
It seems that the conversion of a double/denorm value into a
<BR>
float/denorm gets truncated into 0.0 . In the attached example, the
<BR>
(correct) double result of the fmod , get chopped ( ie cvtts/s ) into
<BR>
0.0 and stored in c.
<BR>
<P>I was expecting to see the float denorm of 0x1 back.
<BR>
/gat
<BR>
<P><P><P>
main()
<BR>
{
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extern double fmod( double a, double b );
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float a, b, c;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;union {
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float	f;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int	i;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} u;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long	fpcr;
<BR>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asm( &quot;excb; mf_fpcr %0&quot; : &quot;=f&quot;(fpcr));
<BR>
printf(&quot; fpcr = %p\n&quot;, fpcr );
<BR>
#if 1
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fpcr |= (1L &lt;&lt; 47);     /* DNOD  Not avail in 21264(a) */
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fpcr &amp;= ~(1L &lt;&lt; 48 );   /* DNZ idenormal Operands to Zero */
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fpcr |= (1L &lt;&lt; 49);     /* DNOD  Not avail in 21264(a) */
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fpcr &amp;= ~(1L &lt;&lt; 60 );   /* UNDZ underflow to zero OFF */
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fpcr |= (1L &lt;&lt; 61);     /* UNFD underflow disable ON */
<BR>
/*      fpcr |= (1L &lt;&lt; 62);      UNFD */
<BR>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asm volatile ( &quot;mt_fpcr %0 ; excb&quot; : : &quot;f&quot;(fpcr));
<BR>
#endif
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asm( &quot;excb; mf_fpcr %0&quot; : &quot;=f&quot;(fpcr));
<BR>
printf(&quot; fpcr = %p\n&quot;, fpcr );
<BR>
<P><P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u.i = 1;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a = u.f;
<BR>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u.i = 0xff800000;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b = u.f;
<BR>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c = fmod( a, b );
<BR>
}
<BR>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<BR>
<P>
<P><P><P>_______________________________________________
<BR>
Axp-list mailing list
<BR>
Axp-list@redhat.com
<BR>
https://listman.redhat.com/mailman/listinfo/axp-list
<BR>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0568.shtml">Jeff Sturm: "Re: gcc"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0566.shtml">David Rysdam: "Re: NFS and Alpha"</A>
<!-- nextthread="start" -->
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR> 
     <P> 
     <SMALL> 
     <EM> 
     This archive was generated by  <A HREF="http://www.landfield.com/hypermail">hypermail version 2a22 </A> on Sun Oct  1 07:47:35 2000 PDT <BR>
	Send any problems or questions about this archive to <A HREF="mailto:webmaster@alphalinux.org">webmaster@alphalinux.org</A>. 
     </EM> 
     </SMALL> 
     </BODY> 
     </HTML> 
