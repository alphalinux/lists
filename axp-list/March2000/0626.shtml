<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN"> 
     <HTML> 
     <HEAD> 
     <TITLE>Axp-List Archive</TITLE> 
     <LINK REV="made" HREF="mailto:mailto-address"> 
     <HEAD> 
     <BODY BGCOLOR="#DC9D33" TEXT="#000000" LINK="#DD0000" ALINK="#CC0000" VLINK="#CC0000">
		<CENTER>  <!--#exec cgi="/cgi-bin/banmat1.cgi"--></CENTER>

     <H1 ALIGN=CENTER>Axp-List Archive<BR> vmlinux .got size &gt; 64k and Oops</H1> 
	
<!-- received="Fri Mar 31 12:45:54 2000" -->
<!-- isoreceived="20000331204554" -->
<!-- sent="Fri, 31 Mar 2000 13:32:59 +0100" -->
<!-- isosent="20000331123259" -->
<!-- name="David Addison" -->
<!-- email="addy@quadrics.com" -->
<!-- subject="vmlinux .got size &gt; 64k and Oops" -->
<!-- id="38E49AFB.131E6088@quadrics.com" -->
<STRONG>Subject: </STRONG>vmlinux .got size > 64k and Oops<BR>
<STRONG>From: </STRONG>David Addison (<EM>addy@quadrics.com</EM>)<BR>
<STRONG>Date: </STRONG>Fri Mar 31 04:32:59 2000
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.shtml#626">[ date ]</A>
<A HREF="index.shtml#626">[ thread ]</A>
<A HREF="subject.shtml#626">[ subject ]</A>
<A HREF="author.shtml#626">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0627.shtml">Matt Spong: "MySQL"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0625.shtml">Nikita Schmidt: "Re: 2.3.99-3 axp combo patch"</A>
<!-- nextthread="start" -->
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
Hi again,
<BR>
in my quest to stop my module from generating Oops whenever I touch a bad user
<BR>
pointer using copy_from_user() I think I have found the root cause. The problem
<BR>
stems from the values in the kernel __ex_table section not matching up with the
<BR>
instructions that they are supposed to protect. I think this is caused by the
<BR>
linker getting confused when the .got table exceeds 64k bytes. Looking at a
<BR>
stock RH6.1 kernel we see;
<BR>
<P>objdump -h /boot/vmlinux-2.2.13-0.9
<BR>
<P>Idx Name          Size      VMA               LMA               File off  Algn
<BR>
11 .got          00011190  fffffc00005737e8  fffffc00005737e8  002737e8  2**3
<BR>
<P>0x11190 = 70032
<BR>
<P>So running a simple program like;
<BR>
<P>main()
<BR>
{
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poll( 0, 10, 10);
<BR>
}
<BR>
<P>Generates;
<BR>
<P>&nbsp;&lt;1&gt;Unable to handle kernel paging request at virtual address 0000000000000000
<BR>
a.out(636): Oops 0
<BR>
pc = [&lt;fffffc00004a7be0&gt;]  ra = [&lt;fffffc000035975c&gt;]  ps = 0000
<BR>
<P><P>So apart from putting the kernel on a big diet is there anyway to fix this e.g.
<BR>
is the linker (ld) broken ?
<BR>
<P>Cheers,
<BR>
Addy.
<BR>
<P><P><P><P><PRE>
-- 
To unsubscribe: send e-mail to axp-list-request@redhat.com with
'unsubscribe' as the subject.  Do not send it to axp-list@redhat.com
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0627.shtml">Matt Spong: "MySQL"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0625.shtml">Nikita Schmidt: "Re: 2.3.99-3 axp combo patch"</A>
<!-- nextthread="start" -->
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR> 
     <P> 
     <SMALL> 
     <EM> 
     This archive was generated by  <A HREF="http://www.landfield.com/hypermail">hypermail version 2a22 </A> on Sat Apr  1 04:15:01 2000 PST <BR>
	Send any problems or questions about this archive to <A HREF="mailto:webmaster@alphalinux.org">webmaster@alphalinux.org</A>. 
     </EM> 
     </SMALL> 
     </BODY> 
     </HTML> 
