<!-- received="Thu Aug  8 09:05:47 1996 " -->
<!-- sent="Thu, 08 Aug 1996 08:47:06 -0400" -->
<!-- name="jestabro@amt.tay1.dec.com" -->
<!-- email="jestabro@amt.tay1.dec.com" -->
<!-- subject="Re: Serial ports and AXP" -->
<!-- id="199608081247.IAA12796@linux03.amt.tay1.dec.com" -->
<!-- inreplyto="199608080508.AAA06099@saratoga.compassnet.com" -->
<HTML><HEAD><META NAME="htdig-email" CONTENT="webmaster@redhat.com"><TITLE>Re: Serial ports and AXP</TITLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#ececec"  LINK="#3333cc" VLINK="#666666"><h2>Re: Serial ports and AXP</h2>

<a href="mailto:jestabro@amt.tay1.dec.com"><i>jestabro@amt.tay1.dec.com</i></a><br>
<i>Thu, 08 Aug 1996 08:47:06 -0400</i>
<p>
<ul>
<li> <b>Messages sorted by:</b> <a href="date.html#240">[ date ]</a><a href="index.html#240">[ thread ]</a><a href="subject.html#240">[ subject ]</a><a href="author.html#240">[ author ]</a>
<!-- next="start" -->
<li> <b>Next message:</b> <a href="0241.html">Richard Henderson: "Re: Dynamic libraries"</a>
<li> <b>Previous message:</b> <a href="0239.html">jestabro@amt.tay1.dec.com: "Re: OK, _another_ UDB sound question :-)"</a>
<li> <b>In reply to:</b> <a href="0232.html">Mike Cruse: "Dynamic libraries"</a>
<!-- nextthread="start" -->
<!-- reply="end" -->
</ul>
<!-- body="start" -->
<i>&gt;&gt;&gt; Brian Walters said:</i><br>
<i>&gt; System: UDB and RedHat 3.0.3 and the special serial cable</i><br>
<i>&gt; </i><br>
<i>&gt; I'm having problems getting the serial ports to work worth a flip. I can </i><br>
<i>&gt; echo things to them w/ a terminal attached, I can even start minicom and </i><br>
<i>&gt; do an ATDT to get a dial tone. The problem seems to be flow control. When </i><br>
<i>&gt; I echo to a terminal it takes about 20 seconds for the message to be </i><br>
<i>&gt; echo'd and then I get my prompt back on the Alpha. I tried an ati4 in </i><br>
<i>&gt; minicom to get the modem info of my US Robotics all I managed to get from </i><br>
<i>&gt; it was</i><br>
<i>&gt; "USRobotics Sp"</i><br>
<p>
Um, you sure it wasn't 16 characters long, not 13?  "Cuz 16 is the size of the<br>
FIFO, and if the serial port interrupt is not coming through, the driver will <br>
time out after 10 seconds and dump the FIFO, over and over and over... :-( :-(<br>
<p>
I thought we had this one fixedm *way* before 1.3.90, which came with 3.0.3.<br>
Are you using an older kernel for some reason, or are you booting from SRM<br>
instead of ARC? What version of ARC firmware do you have?<br>
<p>
See, the problem is simple: serial ports on the UDB need "level" triggered<br>
interrupts (like PCI devices). We tried to be generic in setting up the<br>
edge/level trigger bits, so we could handle UDB and NONAME with the same<br>
MILO and kernel images, even though NONAME's serial ports use edge triggered<br>
interrupts. So we read whatever the console has setup, and leave the serial<br>
port's interrupts the way they were set by the console, in the normal case,<br>
this is ARC console (MILO uses whatever it finds).<br>
<p>
Now, MILO uses polling to handle the serial echoing, I believe, so it wouldn't<br>
run into this problem, and it won't change those bits. So one of a number of <br>
things is happening:<br>
<p>
1. either ARC or SRM is setting them incorrectly before MILO sees them.<br>
<p>
2. MILO is for some reason, trashing them (*very* unlikely).<br>
<p>
3. the kernel is trashing them for some reason (also unlikely).<br>
<p>
4. once the kernel has booted, something else is touching them.<br>
<p>
Hmm, another thought occurs; I guess you could run into this problem if<br>
you put MILO into the FLASH ROM of a UDB, since MILO assumes somebody else<br>
did some setup before it runs. If that somebody *doesn't* run, then MILO<br>
will prolly not know or do the proper setup.<br>
<p>
Email me if you want a pointer to where and what you'd need to patch to<br>
force the serial port interrupts to be set "level" (hint: bios32.c:sio_fixup).<br>
<p>
--Jay++<br>
<p>
-------------------------------------------------------------------------------<br>
  American Non Sequitur Society: we don't make sense, but we do like pizza...<br>
<p>
Jay A Estabrook                         Alpha Migration Tools - LINUX Project<br>
Digital Equipment Corp.                 (508) 952-4202 or (DTN) 227-4202<br>
151 Taylor Street - TAY1-2              enet: <a href="mailto:jestabro@amt.tay1.dec.com">jestabro@amt.tay1.dec.com</a><br>
Littleton, MA 01460-1407                decnet: tallis::jestabro<br>
-------------------------------------------------------------------------------<br>
<p>
<p>
<pre>
--
To unsubscribe: mail -s unsubscribe <a href="mailto:axp-list-request@redhat.com">axp-list-request@redhat.com</a> &lt; /dev/null
</pre>
<!-- body="end" -->
<p>
<ul>
<!-- next="start" -->
<li> <b>Next message:</b> <a href="0241.html">Richard Henderson: "Re: Dynamic libraries"</a>
<li> <b>Previous message:</b> <a href="0239.html">jestabro@amt.tay1.dec.com: "Re: OK, _another_ UDB sound question :-)"</a>
<li> <b>In reply to:</b> <a href="0232.html">Mike Cruse: "Dynamic libraries"</a>
<!-- nextthread="start" -->
<!-- reply="end" -->
</ul>
<br clear=all>
<hr>
<center>
<a href="mailto:webmaster@redhat.com"   target="">Feedback</a> | 
<a href="http://www.redhat.com/products/"   target="">Store</a> | 
<a href="http://www.redhat.com/news/"   target="">News</a> | 
<a href="http://www.redhat.com/support/"   target="">Support</a> | 
<a href="http://www.redhat.com/support/docs/errata.html"   target="">Product Errata</a> | 
<a href="http://www.redhat.com/redhat/"   target="">About Us</a> | 
<a href="http://www.redhat.com/linux-info/"   target="">Linux Info</a> | 
<a href="http://www.redhat.com/search/"   target="">Search</a> | 
<a href="http://www.redhat.com/jumplist.phtml"   target="">JumpWords</a>
<br>
<a href="http://www.redhat.com/cgi-bin/frames.phtml?fr=n"  _top target="_top">No Frames</a> | 
<a href="http://www.redhat.com/cgi-bin/frames.phtml?fr=y"  _top target="_top">Show Frames</a>
</center>
<p align=center>
Copyright &copy; 1995-1997 Red Hat Software. <a href="http://www.redhat.com/redhat/website.html#legal"   target="">Legal notices</a>
</p>
</BODY></HTML>
