<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>axp-list: Bug in PALcode for 21066.</TITLE>
<META NAME="Author" CONTENT="Oleg Gusev (oleg@usm.uni-muenchen.de)">
<META NAME="Subject" CONTENT="Bug in PALcode for 21066.">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Bug in PALcode for 21066.</H1>
<HR>
<P>
<!-- received="Thu Mar 18 17:05:09 1999 PST" -->
<!-- sent="Thu, 18 Mar 1999 17:52:52 +0100" -->
<!-- name="Oleg Gusev" -->
<!-- email="oleg@usm.uni-muenchen.de" -->
<!-- subject="Bug in PALcode for 21066." -->
<!-- id="36F12F64.2C4F3492@usm.uni-muenchen.de" -->
<!-- inreplyto="" -->
<STRONG>Oleg Gusev</STRONG> (<A HREF="mailto:oleg@usm.uni-muenchen.de?subject=Re:%20Bug%20in%20PALcode%20for%2021066."><EM>oleg@usm.uni-muenchen.de</EM></A>)<BR>
<EM>Thu, 18 Mar 1999 17:52:52 +0100</EM>
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#1039">[ date ]</A>
<A HREF="index.html#1039">[ thread ]</A>
<A HREF="subject.html#1039">[ subject ]</A>
<A HREF="author.html#1039">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="1040.html">Michal Jaegermann: "Re: dhcpcd and 2.2 kernels..."</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="1038.html">Greg Lindahl: "Re: How to link or convert and DEC UNIX object file ?"</A>
<!-- nextthread="start" -->
</UL>
<HR>
<!-- body="start" -->
<P>
&nbsp;The following code in palcode/noname/osfpal.S seems to be incorrect:
<BR>
<P><EM>&gt; ** Read the signature value and determine if PALcode is to follow a
</EM><BR>
<EM>&gt; ** standard transfer protocol from the POST code.
</EM><BR>
<EM>&gt; */
</EM><BR>
<EM>&gt;        srl     a3, 16, t7              # Shift signature into lower word.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;        LDLI(t6,0xDECB)                 # Load the expected valid signature.
</EM><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^^^^^^^
<BR>
<P>According to milo.h and my own experience with AXPpci33 it must
<BR>
be 0xDECA. This line prevents proper operation of memory sizing code,
<BR>
etc.
<BR>
<P>&nbsp;The palcode/noname/platform.S must be also corrected. 
<BR>
<P><EM>&gt; sys_cserve_jtopal:
</EM><BR>
<EM>&gt;        bic     a0, 3, t8               # Clear out low 2 bits of address
</EM><BR>
<EM>&gt;        bis     t8, 1, t8               # Or in PAL mode bit
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;        mfpr    t11, ptImpure           # Get base of impure scratch area.
</EM><BR>
<EM>&gt;        lda     t11, CNS_Q_BASE(t11)    # Point to start of save state area.
</EM><BR>
<EM>&gt;        ldq_p   a3, CNS_Q_SIGNATURE(t11)# Read the saved protocol signature.
</EM><BR>
<EM>&gt;        srl     a3, 16, t0              # Shift signature into lower word.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;        LDLI(t1,0xDECB)                 # Load the expected valid signature.
</EM><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^^^^^^^
<BR>
<P>After this change my MILO finally behaves as expected.
<BR>
<P>&nbsp;Oleg.
<BR>
<P><PRE>
-- 
To unsubscribe: send e-mail to <A HREF="mailto:axp-list-request@redhat.com?subject=Re:%20Bug%20in%20PALcode%20for%2021066.">axp-list-request@redhat.com</A> with
'unsubscribe' as the subject.  Do not send it to <A HREF="mailto:axp-list@redhat.com?subject=Re:%20Bug%20in%20PALcode%20for%2021066.">axp-list@redhat.com</A>
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="1040.html">Michal Jaegermann: "Re: dhcpcd and 2.2 kernels..."</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="1038.html">Greg Lindahl: "Re: How to link or convert and DEC UNIX object file ?"</A>
<!-- nextthread="start" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.landfield.com/hypermail/">hypermail 2.0b3</A> 
on <EM>Thu Mar 18 1999 - 10:00:23 PST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
