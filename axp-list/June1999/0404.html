<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>axp-list: Re: Memory and performance with an alpha based Linux</TITLE>
<META NAME="Author" CONTENT="Bill Roman (roman@songdog.eskimo.com )">
<META NAME="Subject" CONTENT="Re: Memory and performance with an alpha based Linux box">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: Memory and performance with an alpha based Linux box</H1>
<HR>
<P>
<!-- received="Sat Jun 19 18:50:36 1999" -->
<!-- isoreceived="19990620015036" -->
<!-- sent="Sat, 19 Jun 1999 08:50:34 -0700 (PDT)" -->
<!-- isosent="19990619155034" -->
<!-- name="Bill Roman" -->
<!-- email="roman@songdog.eskimo.com " -->
<!-- subject="Re: Memory and performance with an alpha based Linux box" -->
<!-- id="m10vNO6-00001zC@songdog" -->
<!-- inreplyto="Pine.LNX.4.10.9906181950540.635-100000@tardis.home.dave" -->
<STRONG>Subject: </STRONG>Re: Memory and performance with an alpha based Linux box<BR>
<STRONG>From: </STRONG>Bill Roman (<EM>roman@songdog.eskimo.com </EM>)<BR>
<STRONG>Date: </STRONG>Sat Jun 19 1999 - 08:50:34 PDT
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#404">[ date ]</A>
<A HREF="index.html#404">[ thread ]</A>
<A HREF="subject.html#404">[ subject ]</A>
<A HREF="author.html#404">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0405.html">Leslie Donaldson: "Milo and Raid level1"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0403.html">Michal Jaegermann: "Re: 2.2.{9,10} strangeness"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0396.html">Dave Gilbert: "RE: Memory and performance with an alpha based Linux box"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0486.html">Rich Payne: "Re: Memory and performance with an alpha based Linux box"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0396.html">Bill Roman: "Re: Memory and performance with an alpha based Linux box"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
Dave Gilbert wrote:
<BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; On Fri, 18 Jun 1999, Jeff Bolle wrote:
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; &gt; I believe alphalinux supports up to 2 gigs of ram, which is a limitation
</EM><BR>
<EM>&gt; &gt; thrust upon it by the intel side (i believe, there are probably many more
</EM><BR>
<EM>&gt; &gt; knowledgeable people on here than me who know more on that)
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; The problem is actually PCI ; 32 bit PCI cards only have a limited memory
</EM><BR>
<EM>&gt; space that they can see (2GB or is it 4...) and you have to teach drivers
</EM><BR>
<EM>&gt; about that so drivers and things which are trying to talk to SCSI cards
</EM><BR>
<EM>&gt; and the like need to know that if they have a lot of RAM that they can't
</EM><BR>
<EM>&gt; DMA into any old chunk of it.
</EM><BR>
<P>Jeff and Dave both have part of the story; here are a few more details.
<BR>
<P>Most common PCI cards can only generate 32-bit memory addresses.  This is
<BR>
sufficient to span 4 GB.  Part of this address space is occupied by
<BR>
memory-mapped devices (a good example being video card frame buffers), so
<BR>
less than 4 GB is available as a region to be mapped to system memory for
<BR>
PCI devices to do DMA transfers.  The simplest hardware design allocates
<BR>
such regions in chunks whose size is a power of two, hence the 2 GB limit.
<BR>
<P>Because of their 32-bit address capabilities, Intel architecture systems
<BR>
have generally blurred the distinction between the 4 GB PCI memory address
<BR>
space and their 4 GB system memory space.  DMA devices pretty much deal
<BR>
with system memory addresses, without any consideration that the PCI
<BR>
and system memory address spaces are actually two different things.
<BR>
This is often referred to as &quot;direct mapped&quot; DMA.
<BR>
<P>Even the first Alpha systems had more than 32 physical address bits
<BR>
out of the processor; the EV6 has 44.  Alpha system chipsets allocate
<BR>
completely separate physical address space for each PCI bus, and must
<BR>
provide translation from bus addresses to memory addresses.  They have
<BR>
the capability of using direct mapped translation just like Intel;
<BR>
this works fine for small (2 GB or less) system memory.
<BR>
<P>But to accommodate large memory (as well as for other reasons), Alphas
<BR>
also have &quot;scatter/gather&quot; DMA address translation.  The bus address space
<BR>
that is used for DMA is split into pages, and a single-level page table
<BR>
translates bus addresses to memory addresses.  This has the advantage
<BR>
that the DMA device's view of the destination buffer can be made to
<BR>
match the program's virtually contiguous (but physically discontiguous)
<BR>
buffer; it has the disadvantage that there is additional CPU overhead
<BR>
to manage the scatter/gather map.
<BR>
<P>There was some discussion recently of implementing scatter/gather DMA
<BR>
in Linux; it would be beneficial on Alpha, and probably also on (excuse
<BR>
my language) Merced.  Maybe we can look forward to this in 2.3?
<BR>
<P>There are quite a few details I've glossed over here: the legacy ISA
<BR>
memory hole above 640K, and the &quot;Physical Address Extension&quot; (PAE)
<BR>
feature of newer Intel processors, as well as Intel's recent &quot;invention&quot;
<BR>
of scatter/gather DMA in connection with AGP.  If you're eyes haven't
<BR>
glazed over already, but your interest has been piqued, check out the
<BR>
processor and chipset specs on Intel's web site.
<BR>
<P><PRE>
-- 
Bill Roman  (roman@songdog.eskimo.com / roman@songdog.uucp)   running linux
<P>-- 
To unsubscribe: send e-mail to axp-list-request@redhat.com with
'unsubscribe' as the subject.  Do not send it to axp-list@redhat.com
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0405.html">Leslie Donaldson: "Milo and Raid level1"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0403.html">Michal Jaegermann: "Re: 2.2.{9,10} strangeness"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0396.html">Dave Gilbert: "RE: Memory and performance with an alpha based Linux box"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0486.html">Rich Payne: "Re: Memory and performance with an alpha based Linux box"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0396.html">Bill Roman: "Re: Memory and performance with an alpha based Linux box"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Wed Jun 30 1999 - 19:27:26 PDT</EM>
</EM>
</SMALL>
</BODY>
</HTML>
