<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>axp-list: Re: A guru problem (shared libs)</TITLE>
<META NAME="Author" CONTENT="Christopher W. Curtis (ccurtis@aet-usa.com)">
<META NAME="Subject" CONTENT="Re: A guru problem (shared libs)">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: A guru problem (shared libs)</H1>
<HR>
<P>
<!-- received="Wed May 05 06:10:57 1999" -->
<!-- isoreceived="19990505131057" -->
<!-- sent="Wed, 05 May 1999 01:32:55 -0500" -->
<!-- isosent="19990505063255" -->
<!-- name="Christopher W. Curtis" -->
<!-- email="ccurtis@aet-usa.com" -->
<!-- subject="Re: A guru problem (shared libs)" -->
<!-- id="372FE617.D0451302@aet-usa.com" -->
<!-- inreplyto="19990502131312.B2505@twiddle.net" -->
<STRONG>Subject: </STRONG>Re: A guru problem (shared libs)<BR>
<STRONG>From: </STRONG>Christopher W. Curtis (<EM>ccurtis@aet-usa.com</EM>)<BR>
<STRONG>Date: </STRONG>Tue May 04 1999 - 23:32:55 PDT
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#89">[ date ]</A>
<A HREF="index.html#89">[ thread ]</A>
<A HREF="subject.html#89">[ subject ]</A>
<A HREF="author.html#89">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0090.html">designer seven: "Re: 5.2--&gt;6.0 update advice [Was: Cannot connect to X server]"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0088.html">J. Pedro Sousa do Amaral: "5.2--&gt;6.0 update advice [Was: Cannot connect to X server]"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0168.html">Christopher Curtis: "Re: A guru problem (shared libs)"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
Richard Henderson wrote:
<BR>
<P><EM>&gt; On Wed, Apr 28, 1999 at 08:31:29PM -0500, Christopher W. Curtis wrote:
</EM><BR>
<EM>&gt; &gt; What package do I need to (re)install to get this to function porperly,
</EM><BR>
<EM>&gt; &gt; and please don't say glibc-2.0.7 (the RH 5.2 version) because I've
</EM><BR>
<EM>&gt; &gt; already tried that, and each time I try it something goes hokey and the
</EM><BR>
<EM>&gt; &gt; machine is dead for another day while I delete symlinks in /lib.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; Sorry, it's glibc.  You've got /lib/libc* and /lib/ld-*.so mismatched.
</EM><BR>
<P>Thanks for responding (I recognize your name as guru-ness), but I'm still
<BR>
stuck and simply cannot figure out how to proceed.  :(
<BR>
<P>Here is my /etc/ld.so.conf:
<BR>
/lib
<BR>
/usr/lib
<BR>
/usr/X11R6/lib
<BR>
/usr/local/lib
<BR>
<P><P>Here is /lib/libc* and /lib/ld*:
<BR>
-rwxr-xr-x   1 root     root       301815 Oct 12  1998 /lib/ld-2.0.7.so
<BR>
lrwxrwxrwx   1 root     root           11 Apr 27  2019 /lib/ld-linux.so.2 -&gt;
<BR>
ld-2.0.7.so
<BR>
<P>-rwxr-xr-x   1 root     root      4462177 Oct 12  1998 /lib/libc-2.0.7.so
<BR>
lrwxrwxrwx   1 root     root           13 Mar  2  2019 /lib/libc.so.6 -&gt;
<BR>
libc-2.0.7.so
<BR>
lrwxrwxrwx   1 root     root           13 Apr 22  2019 /lib/libc.so.6.1 -&gt;
<BR>
libc-2.0.7.so
<BR>
<P><P>Ignore the dates on the symlinks - I created those manually after a fudged
<BR>
2.1 libc install forced me to boot from floppy and manually remove the bad
<BR>
package and recreate the original layout.
<BR>
<P>Now, the thing is, it appears that *everything* works, with the sole
<BR>
exception of the binutils package.  I can run &quot;gcc&quot;.  I can run &quot;apache&quot;.  I
<BR>
can run &quot;samba&quot;.  I can run 99% of the things that I want to run every day.
<BR>
I cannot, however, run anything from binutils.  Each of the programs &quot;ar&quot;,
<BR>
&quot;nm&quot;, &quot;as&quot;, &quot;ranlib&quot;, &quot;ld&quot;, &quot;strip&quot;, and &quot;strings&quot; produce the error:
<BR>
(program): error in loading shared libraries
<BR>
/usr/lib/libc.so.6.1: undefined symbol: _dl_initial_searchlist
<BR>
<P>I've uninstalled binutils and reinstalled them.  I've forced their
<BR>
reinstallation using:
<BR>
2540552 Feb 25 22:16
<BR>
/usr/local/cdrom/yummy/installed/binutils-2.9.1.0.15-1.alpha.rpm
<BR>
<P>which should be the same as the one from the CD-ROM (I downloaded it off the
<BR>
'net, though, so I can't say for sure).  I recently downloaded .0.23-4 as a
<BR>
SRPM, but not surprisingly (but so at the time), I can't compile it.
<BR>
<P>I've checked the dependencies for binutils and forced reinstallation of
<BR>
those packages.  &quot;rpm -qR binutils&quot; states that it depends on:
<BR>
/bin/sh
<BR>
/sbin/ldconfig
<BR>
ld-linux.so.2
<BR>
libbfd-2.9.1.0.15.so.0
<BR>
libc.so.6.1
<BR>
libopcodes-2.9.1.0.15.so.0
<BR>
<P>No packages seem to provide &quot;/bin/sh&quot; or &quot;/sbin/ldconfig&quot;, so I'm guessing
<BR>
&quot;bash&quot; and &quot;ldconfig&quot; respectively.  &quot;rpm -qlv&quot; of bash-1.14.7-13.alpha.rpm&quot;
<BR>
lists &quot;/bin/sh&quot; and of &quot;ldconfig-1.9.5-8.alpha.rpm&quot;, &quot;/sbin/ldconfig&quot;; and
<BR>
trying to &quot;rpm -U&quot; these packages rpm states that they are already
<BR>
installed.
<BR>
<P>ld-linux.so.2 and libc.so.6.1 are both provided for by &quot;glibc-2.0.7-29&quot; and
<BR>
libbfd and libopcodes are both provided by &quot;binutils-2.9.1.0.15-1&quot;.
<BR>
<P>So performing an &quot;rpm -U bash* binutils* glibc-2* ldconfig*&quot; results in:
<BR>
package bash-1.14.7-13 is already installed
<BR>
error: bash-1.14.7-13.alpha.rpm cannot be installed
<BR>
package ldconfig-1.9.5-8 is already installed
<BR>
error: ldconfig-1.9.5-8.alpha.rpm cannot be installed
<BR>
package binutils-2.9.1.0.15-1 is already installed
<BR>
error: binutils-2.9.1.0.15-1.alpha.rpm cannot be installed
<BR>
package glibc-2.0.7-29 is already installed
<BR>
error: glibc-2.0.7-29.alpha.rpm cannot be installed
<BR>
<P>The same command with &quot;--force&quot; produces no output on stdout or stderr.  I
<BR>
then, from a new command prompt (I telnet in from another machine) perform a
<BR>
test:
<BR>
as: error in loading shared libraries
<BR>
/usr/lib/libc.so.6.1: undefined symbol: _dl_initial_searchlist
<BR>
<P>I am now at a complete loss.  I try two more things:
<BR>
ldd `which as`
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;libopcodes-2.9.1.0.15.so.0 =&gt; /usr/lib/libopcodes-2.9.1.0.15.so.0
<BR>
(0x0000015555556000)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;libbfd-2.9.1.0.15.so.0 =&gt; /usr/lib/libbfd-2.9.1.0.15.so.0
<BR>
(0x000001555566c000)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;libc.so.6.1 =&gt; /usr/lib/libc.so.6.1 (0x00000155557d8000)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/lib/ld-linux.so.2 =&gt; /lib/ld-linux.so.2 (0x0000000000000000)
<BR>
<P>ldd `which cc`
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;libc.so.6.1 =&gt; /lib/libc.so.6.1 (0x000001555555c000)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/lib/ld-linux.so.2 =&gt; /lib/ld-linux.so.2 (0x0000000000000000)
<BR>
<P>ld-linux.so.2 both have the same entry point.  &quot;ifconfig&quot; has the same entry
<BR>
into libc as cc.  More testing with other progrmas show that they enter libc
<BR>
at varying places.  All the &quot;broken&quot; programs depend on libbfd it seems:
<BR>
ldd `which strings`
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;libbfd-2.9.1.0.15.so.0 =&gt; /usr/lib/libbfd-2.9.1.0.15.so.0
<BR>
(0x0000015555556000)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;libc.so.6.1 =&gt; /usr/lib/libc.so.6.1 (0x00000155556c6000)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/lib/ld-linux.so.2 =&gt; /lib/ld-linux.so.2 (0x0000000000000000)
<BR>
<P>ls -l libbfd*
<BR>
lrwxrwxrwx   1 root     root           26 Apr 30 14:29
<BR>
libbfd-2.9.1.0.15.so.0 -&gt; libbfd-2.9.1.0.15.so.0.0.0
<BR>
-rwxr-xr-x   1 root     root      1454276 Oct 13  1998
<BR>
libbfd-2.9.1.0.15.so.0.0.0
<BR>
-rw-r--r--   1 root     root      2887892 Oct 13  1998 libbfd.a
<BR>
-rw-r--r--   1 root     root          482 Oct 13  1998 libbfd.la
<BR>
lrwxrwxrwx   1 root     root           26 Apr 30 14:29 libbfd.so -&gt;
<BR>
libbfd-2.9.1.0.15.so.0.0.0
<BR>
<P>As far as I can see, everything should be in order here.
<BR>
<P>rpm -q --whatrequires libbfd-2.9.1.0.15.so.0
<BR>
binutils-2.9.1.0.15-1
<BR>
rpm -q --whatprovides libbfd-2.9.1.0.15.so.0
<BR>
binutils-2.9.1.0.15-1
<BR>
<P>And `strace as`:
<BR>
execve(&quot;/usr/bin/as&quot;, [&quot;as&quot;], [/* 18 vars */]) = 0
<BR>
brk(0)                                  = 0x12014bf08
<BR>
open(&quot;/etc/ld.so.preload&quot;, O_RDONLY)    = -1 ENOENT (No such file or
<BR>
directory)
<BR>
open(&quot;/usr/lib/libopcodes-2.9.1.0.15.so.0&quot;, O_RDONLY) = 3
<BR>
mmap(0, 0, PROT_NONE, 0 /* MAP_??? */, 0, 0) = 0x15555566000
<BR>
munmap(0x15555566000, 8192)             = 0
<BR>
mmap(0, 8192, PROT_NONE, 0 /* MAP_??? */, 0, 0) = 0x15555666000
<BR>
mprotect(0x15555672000, 1065720, PROT_NONE) = 0
<BR>
mmap(0x15555766000, 1065720, PROT_NONE, 0 /* MAP_??? */, 0, 0) =
<BR>
0x15555766000
<BR>
close(3)                                = 0
<BR>
open(&quot;/usr/lib/libbfd-2.9.1.0.15.so.0&quot;, O_RDONLY) = 3
<BR>
mmap(0, 0, PROT_NONE, 0 /* MAP_??? */, 0, 0) = 0x15555566000
<BR>
mmap(0, 0, PROT_NONE, 0 /* MAP_??? */, 0, 0) = 0x15555568000
<BR>
munmap(0x15555566000, 8192)             = 0
<BR>
mmap(0, 8192, PROT_NONE, 0 /* MAP_??? */, 0, 0) = 0x15555778000
<BR>
mprotect(0x155557de000, 1072496, PROT_NONE) = 0
<BR>
mmap(0x155558d8000, 1072496, PROT_NONE, 0 /* MAP_??? */, 0, 0) =
<BR>
0x155558d8000
<BR>
close(3)                                = 0
<BR>
open(&quot;/usr/lib/libc.so.6.1&quot;, O_RDONLY)  = 3
<BR>
mmap(0, 0, PROT_NONE, 0 /* MAP_??? */, 0, 0) = 0x15555566000
<BR>
munmap(0x15555566000, 8192)             = 0
<BR>
mmap(0, 8192, PROT_NONE, 0 /* MAP_??? */, 0, 0) = 0x155558e4000
<BR>
mprotect(0x15555a02000, 1115676, PROT_NONE) = 0
<BR>
mmap(0x15555af4000, 1115676, PROT_NONE, 0 /* MAP_??? */, 0, 0) =
<BR>
0x15555af4000
<BR>
mmap(0x15555b0e000, 1115676, PROT_NONE, 0 /* MAP_??? */, 0, 0) =
<BR>
0x15555b0e000
<BR>
close(3)                                = 0
<BR>
write(2, &quot;as&quot;, 2as)                       = 2
<BR>
write(2, &quot;: error in loading shared librar&quot;..., 36: error in loading shared
<BR>
libraries
<BR>
) = 36
<BR>
write(2, &quot;/usr/lib/libc.so.6.1&quot;, 20/usr/lib/libc.so.6.1)    = 20
<BR>
write(2, &quot;: &quot;, 2: )                       = 2
<BR>
write(2, &quot;undefined symbol: _dl_initial_se&quot;..., 40undefined symbol:
<BR>
_dl_initial_searchlist) = 40
<BR>
write(2, &quot;&quot;, 0)                         = 0
<BR>
write(2, &quot;&quot;, 0)                         = 0
<BR>
write(2, &quot;\n&quot;, 1
<BR>
)                       = 1
<BR>
exit(127)                               = ?
<BR>
<P>I am now at a complete and total loss.  I don't see anything wrong with this
<BR>
at all.  Could someone be so kind as to verify some of these numbers that
<BR>
I have or tell me what I should do next?  So far, nobody seems to be able to
<BR>
cast much insight into this problem, and I can't do much else without a
<BR>
working binutils package ...
<BR>
<P>Thanks in advance,
<BR>
Christopher
<BR>
<P><PRE>
-- 
To unsubscribe: send e-mail to axp-list-request@redhat.com with
'unsubscribe' as the subject.  Do not send it to axp-list@redhat.com
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0090.html">designer seven: "Re: 5.2--&gt;6.0 update advice [Was: Cannot connect to X server]"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0088.html">J. Pedro Sousa do Amaral: "5.2--&gt;6.0 update advice [Was: Cannot connect to X server]"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0168.html">Christopher Curtis: "Re: A guru problem (shared libs)"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Tue Jun 01 1999 - 09:56:18 PDT</EM>
</EM>
</SMALL>
</BODY>
</HTML>
