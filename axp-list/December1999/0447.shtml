<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN"> 
     <HTML> 
     <HEAD> 
     <TITLE>Axp-List Archive</TITLE> 
     <LINK REV="made" HREF="mailto:mailto-address"> 
     <HEAD> 
     <BODY BGCOLOR="#DC9D33" TEXT="#000000" LINK="#DD0000" ALINK="#CC0000" VLINK="#CC0000">
		<CENTER>  <!--#exec cgi="/cgi-bin/banmat1.cgi"--></CENTER>

     <H1 ALIGN=CENTER>Axp-List Archive<BR> Re: UPDATE: DATETIME fields incorrect on alpha</H1> 
	
<!-- received="Tue Dec 14 00:55:06 1999" -->
<!-- isoreceived="19991214085506" -->
<!-- sent="Mon, 13 Dec 1999 18:33:23 -0500 (EST)" -->
<!-- isosent="19991213233323" -->
<!-- name="ppetrakis@firestorm.tzo.org" -->
<!-- email="ppetrakis@firestorm.tzo.org" -->
<!-- subject="Re: UPDATE: DATETIME fields incorrect on alpha" -->
<!-- id="Pine.LNX.4.10.9912131816150.24303-100000@voodoo.alphalinux.org" -->
<!-- inreplyto="Pine.LNX.4.10.9912130321170.2187-100000@dialup.isc.tuc.gr" -->
<STRONG>Subject: </STRONG>Re: UPDATE: DATETIME fields incorrect on alpha<BR>
<EM>ppetrakis@firestorm.tzo.org</EM><BR>
<STRONG>Date: </STRONG>Mon Dec 13 15:33:23 1999
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.shtml#447">[ date ]</A>
<A HREF="index.shtml#447">[ thread ]</A>
<A HREF="subject.shtml#447">[ subject ]</A>
<A HREF="author.shtml#447">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0448.shtml">ian reinhart geiser: "RE: Sound for an AlphaStation 200 4/233"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0446.shtml">Michael Rich: "RE: Sound for an AlphaStation 200 4/233"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0414.shtml">Nikolaos Ntarmos: "Re: UPDATE: DATETIME fields incorrect on alpha"</A>
<!-- nextthread="start" -->
<LI><STRONG>Reply:</STRONG> <A HREF="0414.shtml">ppetrakis@firestorm.tzo.org: "Re: UPDATE: DATETIME fields incorrect on alpha"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
On Mon, 13 Dec 1999, Nikolaos Ntarmos wrote:
<BR>
&nbsp;
<BR>
<EM>&gt; TCP_NODELAY is simply defined to be 1 , provided that __KERNEL__ is defined :
</EM><BR>
<EM>&gt; #if defined(__KERNEL__) || !defined(__GLIBC__) || (__GLIBC__ &lt; 2)
</EM><BR>
<EM>&gt; ...
</EM><BR>
<EM>&gt; #define TCP_NODELAY     1
</EM><BR>
<EM>&gt; ...
</EM><BR>
<EM>&gt; #endif /* not kernel and not glibc */
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; in the file $KERNEL_ROOT/include/linux/socket.h and therefore in the standard
</EM><BR>
<EM>&gt; /usr/include/linux/socket.h. All this in my 2.2.14pre9-based system. Try
</EM><BR>
<EM>&gt; defining __KERNEL__ (-D__KERNEL__) during compilation or hardcoding 1 for
</EM><BR>
<EM>&gt; TCP_NODELAY.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Hope i helped...
</EM><BR>
<P>Yes you did help :-) Thank you. Here's what I did.
<BR>
Turns out there was another file that was effected the same way. I patched
<BR>
them as follows:
<BR>
<P>diff -uNr mysql-3.23.7-alpha-GOLD/client/net.c
<BR>
mysql-3.23.7-alpha/client/net.c
<BR>
--- mysql-3.23.7-alpha-GOLD/client/net.c        Mon Nov 29 14:29:51 1999
<BR>
+++ mysql-3.23.7-alpha/client/net.c     Mon Dec 13 11:52:54 1999
<BR>
@@ -8,6 +8,9 @@
<BR>
&nbsp;** 3 byte length &amp; 1 byte package-number.
<BR>
&nbsp;*/
<BR>
+#ifdef alpha_linux_port
<BR>
+#define TCP_NODELAY 1
<BR>
+#endif
<BR>
&nbsp;#ifdef _WIN32
<BR>
&nbsp;#include &lt;winsock.h&gt;
<BR>
&nbsp;#endif
<BR>
diff -uNr mysql-3.23.7-alpha-GOLD/sql/net_serv.c
<BR>
mysql-3.23.7-alpha/sql/net_serv.c
<BR>
--- mysql-3.23.7-alpha-GOLD/sql/net_serv.c      Mon Nov 29 14:29:51 1999
<BR>
+++ mysql-3.23.7-alpha/sql/net_serv.c   Mon Dec 13 13:30:12 1999
<BR>
@@ -8,6 +8,9 @@
<BR>
&nbsp;** 3 byte length &amp; 1 byte package-number.
<BR>
&nbsp;*/
<BR>
+#ifdef alpha_linux_port
<BR>
+#define TCP_NODELAY 1
<BR>
+#endif
<BR>
&nbsp;#ifdef _WIN32
<BR>
&nbsp;#include &lt;winsock.h&gt;
<BR>
&nbsp;#endif
<BR>
<P>Since I pass -D_alpha_linux_port to enable big file support it will catch
<BR>
it and make the define. (BTW it still dumps core with the
<BR>
-D_alpha_linux_port flag)
<BR>
<P>Now I can get this thing to finally compile but it it still SEGV's at
<BR>
startup.
<BR>
<P>I went back to the stable release of MySQL for now (since they both dump
<BR>
core might as well get the one that's stable working first) and ran gdb on
<BR>
the core again.
<BR>
<P>[root@voodoo:~]$ mysqld
<BR>
Segmentation fault (core dumped)
<BR>
[root@voodoo:~]$ gdb mysqld core
<BR>
GNU gdb 4.17.0.11 with Linux support
<BR>
Copyright 1998 Free Software Foundation, Inc.
<BR>
GDB is free software, covered by the GNU General Public License, and you
<BR>
are
<BR>
welcome to change it and/or distribute copies of it under certain
<BR>
conditions.
<BR>
Type &quot;show copying&quot; to see the conditions.
<BR>
There is absolutely no warranty for GDB.  Type &quot;show warranty&quot; for
<BR>
details.
<BR>
This GDB was configured as &quot;alpha-redhat-linux&quot;...
<BR>
Core was generated by `mysqld'.
<BR>
Program terminated with signal 11, Segmentation fault.
<BR>
#0  0x1200d4208 in pthread_setcanceltype (type=1, oldtype=0x11ffffa80)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;at cancel.c:42
<BR>
42        if (oldtype != NULL) *oldtype = THREAD_GETMEM(self,
<BR>
p_canceltype);
<BR>
(gdb) bt
<BR>
#0  0x1200d4208 in pthread_setcanceltype (type=1, oldtype=0x11ffffa80)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;at cancel.c:42
<BR>
#1  0x1200d3368 in fcntl (fd=0, cmd=1) at wrapsyscall.c:77
<BR>
#2  0x1200ddd44 in check_standard_fds () at
<BR>
../sysdeps/generic/libc-start.c:99
<BR>
#3  0x1200ddf30 in __libc_start_main (main=0x120041bc0 &lt;main&gt;, argc=1,
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;argv=0x11ffffb68, init=0x120000120 &lt;_init&gt;, fini=0x12013e260 &lt;_fini&gt;,
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;rtld_fini=0, stack_end=0x11ffffb50) at
<BR>
../sysdeps/generic/libc-start.c:60
<BR>
Current language:  auto; currently c
<BR>
(gdb) l
<BR>
37      int pthread_setcanceltype(int type, int * oldtype)
<BR>
38      {
<BR>
39        pthread_descr self = thread_self();
<BR>
40        if (type &lt; PTHREAD_CANCEL_DEFERRED || type &gt;
<BR>
PTHREAD_CANCEL_ASYNCHRONOUS)
<BR>
41          return EINVAL;
<BR>
42        if (oldtype != NULL) *oldtype = THREAD_GETMEM(self,
<BR>
p_canceltype);
<BR>
43        THREAD_SETMEM(self, p_canceltype, type);
<BR>
44        if (THREAD_GETMEM(self, p_canceled) &amp;&amp;
<BR>
45            THREAD_GETMEM(self, p_cancelstate) == PTHREAD_CANCEL_ENABLE
<BR>
&amp;&amp;
<BR>
46            THREAD_GETMEM(self, p_canceltype) ==
<BR>
PTHREAD_CANCEL_ASYNCHRONOUS)
<BR>
(gdb) 
<BR>
...
<BR>
<P>(gdb) run
<BR>
The program being debugged has been started already.
<BR>
Start it from the beginning? (y or n) y
<BR>
Starting program: /usr/sbin/mysqld
<BR>
Breakpoint 1, pthread_setcanceltype (type=1, oldtype=0x11ffffac0)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;at cancel.c:38
<BR>
38      {
<BR>
(gdb) cont
<BR>
Continuing.
<BR>
Breakpoint 2, pthread_setcanceltype (type=1, oldtype=0x11ffffac0)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;at cancel.c:40
<BR>
40        if (type &lt; PTHREAD_CANCEL_DEFERRED || type &gt;
<BR>
PTHREAD_CANCEL_ASYNCHRONOUS)
<BR>
(gdb) cont
<BR>
Continuing.
<BR>
Breakpoint 4, pthread_setcanceltype (type=1, oldtype=0x11ffffac0)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;at cancel.c:42
<BR>
42        if (oldtype != NULL) *oldtype = THREAD_GETMEM(self,
<BR>
p_canceltype);
<BR>
(gdb) cont
<BR>
Continuing.
<BR>
Program received signal SIGSEGV, Segmentation fault.
<BR>
0x1200d4208 in pthread_setcanceltype (type=1, oldtype=0x11ffffac0)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;at cancel.c:42
<BR>
42        if (oldtype != NULL) *oldtype = THREAD_GETMEM(self,
<BR>
p_canceltype);
<BR>
(gdb) cont
<BR>
Continuing.
<BR>
Error accessing memory address 0x120286088: No such process.
<BR>
<P><P>This is over my head. Any ideas?
<BR>
Thanks.
<BR>
<P>Peter
<BR>
<PRE>
--
www.alphalinux.org
Peter Petrakis         Warrior/Engineer        ppetrakis@alphalinux.org
&quot;Oh my God! They killed Xena! You bastards!!&quot;
&quot;&lt;BLAM!!&gt; Who the hell are you!? Name's Ash &lt;click clock&gt; Housewares...&quot; 
<P>-- 
To unsubscribe: send e-mail to axp-list-request@redhat.com with
'unsubscribe' as the subject.  Do not send it to axp-list@redhat.com
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0448.shtml">ian reinhart geiser: "RE: Sound for an AlphaStation 200 4/233"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0446.shtml">Michael Rich: "RE: Sound for an AlphaStation 200 4/233"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0414.shtml">Nikolaos Ntarmos: "Re: UPDATE: DATETIME fields incorrect on alpha"</A>
<!-- nextthread="start" -->
<LI><STRONG>Reply:</STRONG> <A HREF="0414.shtml">ppetrakis@firestorm.tzo.org: "Re: UPDATE: DATETIME fields incorrect on alpha"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR> 
     <P> 
     <SMALL> 
     <EM> 
     This archive was generated by  <A HREF="http://www.landfield.com/hypermail">hypermail version 2a22 </A> on Mon Jan  3 11:15:10 2000 PST <BR>
	Send any problems or questions about this archive to <A HREF="mailto:webmaster@alphalinux.org">webmaster@alphalinux.org</A>. 
     </EM> 
     </SMALL> 
     </BODY> 
     </HTML> 
