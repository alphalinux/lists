<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>axp-list: Re: PATCH: (on Alpha) emulating missing instructions</TITLE>
<META NAME="Author" CONTENT="Peter Rival (frival@zk3.dec.com)">
<META NAME="Subject" CONTENT="Re: PATCH: (on Alpha) emulating missing instructions">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: PATCH: (on Alpha) emulating missing instructions</H1>
<HR>
<P>
<!-- received="Fri Oct 15 17:10:59 1999" -->
<!-- isoreceived="19991016001059" -->
<!-- sent="Fri, 15 Oct 1999 14:36:56 +0000" -->
<!-- isosent="19991015143656" -->
<!-- name="Peter Rival" -->
<!-- email="frival@zk3.dec.com" -->
<!-- subject="Re: PATCH: (on Alpha) emulating missing instructions" -->
<!-- id="38073C08.ACC8A5FA@zk3.dec.com" -->
<!-- inreplyto="3.0.6.32.19991015071954.0080b7e0@Losninos.org" -->
<STRONG>Subject: </STRONG>Re: PATCH: (on Alpha) emulating missing instructions<BR>
<STRONG>From: </STRONG>Peter Rival (<EM>frival@zk3.dec.com</EM>)<BR>
<STRONG>Date: </STRONG>Fri Oct 15 1999 - 07:36:56 PDT
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#331">[ date ]</A>
<A HREF="index.html#331">[ thread ]</A>
<A HREF="subject.html#331">[ subject ]</A>
<A HREF="author.html#331">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0332.html">Kirk R. Erichsen: "RE: PATCH: (on Alpha) emulating missing instructions"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0330.html">Vanco, Donald: "RE: DS10 clock problem?"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0332.html">Kirk R. Erichsen: "RE: PATCH: (on Alpha) emulating missing instructions"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0333.html">Jemiolo, John: "RE: PATCH: (on Alpha) emulating missing instructions"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0332.html">Peter Rival: "Re: PATCH: (on Alpha) emulating missing instructions"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
Well, to answer his question, it's not a PALcode thing - Tru64 emulates the
<BR>
instructions in the same way this patch intends to.  Otherwise the simple answer
<BR>
would be &quot;use SRM&quot; as it is always up to the latest firmware/PALcode rev (if you
<BR>
keep up with it).
<BR>
<P>That brings us to something better - with the rumored (I'm not in a position at
<BR>
Compaq to know) demise of AlphaBIOS/ARC, what kind of base does that give MILO
<BR>
to work from?  If you're particularly worried, work on getting MILO happy with
<BR>
SRM, and know then that you are working from the latest PALcode.  I know it's
<BR>
not that simple, but I'm hoping that you see where I'm going.
<BR>
<P>While I will say that Compaq has done a lot to help make Linux on Alpha work, I
<BR>
will also admit that there is a _lot_ more that we could do.  Working
<BR>
through/with issues like this should probably rank high on that list.  If you
<BR>
think you know of good things that Compaq can do to make AlphaLinux work better
<BR>
(or in some cases just &quot;work&quot;...but we won't go into that rant...) try to get
<BR>
someone &quot;up the ladder&quot; to send mail to Michael Capellas or Enrico Pesatori or
<BR>
Bill Heill (or all three).  Mail directly from customers with an expressed
<BR>
interest in buying Alpha systems if only Compaq did XYZ has a lot more pull than
<BR>
sending it to axp-list and hoping that a developer can manage to get it up the
<BR>
chain without the message getting distorted.  Something like &quot;there's this
<BR>
customer that said they might think about buying Alpha systems for Linux if we
<BR>
just do blah&quot; really sounds wimpy.
<BR>
<P>Just like Linux, if we all work together everything gets better.  I guess that
<BR>
would be my equivalent of Linus saying &quot;code it up and we'll see&quot;.  I want
<BR>
things to be where you the customer think they need to be...and it _will_
<BR>
happen.  End of story.  (and rant ;)
<BR>
<P>&nbsp;- Pete
<BR>
<P>&quot;Kirk R. Erichsen&quot; wrote:
<BR>
<P><EM>&gt; You better believe we are missing PALcode updates.  The PALcode in MILO
</EM><BR>
<EM>&gt; dates back to the EB series machines and was part of the EBSDK.  The
</EM><BR>
<EM>&gt; PALcode was built from examples from the SDK and are fairly close to the
</EM><BR>
<EM>&gt; Digital UNIX 3.2 versions.  There are a lot of unimplemented functions and
</EM><BR>
<EM>&gt; it is quite old.  If Compaq is serious about Alpha, we need PALcode
</EM><BR>
<EM>&gt; updates, not more kernel hacks.
</EM><BR>
<EM>&gt; The fact that Linux works over Alpha at all is in spite of, not because of
</EM><BR>
<EM>&gt; support from Compaq.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; --Kirk
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; At 12:03 PM 10/15/99 +0200, you wrote:
</EM><BR>
<EM>&gt; &gt;Eminently done, but I was really under the impression that these exceptions
</EM><BR>
<EM>&gt; &gt;should be handled by the PALcode (since it is really a general Alpha
</EM><BR>
<EM>&gt; &gt;problem, not Linux-specific)? Is this not so (i.e. are we missing some
</EM><BR>
<EM>&gt; &gt;PALcode update) or is it solved differently in different OSes?
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt;-----Original Message-----
</EM><BR>
<EM>&gt; &gt;From: Luke Deller [mailto:luked@cse.unsw.edu.au]
</EM><BR>
<EM>&gt; &gt;Sent: Friday, October 15, 1999 11:39 AM
</EM><BR>
<EM>&gt; &gt;To: axp-list@redhat.com
</EM><BR>
<EM>&gt; &gt;Cc: axp-list@redhat.com; Daniel Paul Potts
</EM><BR>
<EM>&gt; &gt;Subject: PATCH: (on Alpha) emulating missing instructions
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt;Daniel &amp; I tried to run Loki's new beta version of Civilization Call to
</EM><BR>
<EM>&gt; &gt;Power for alpha linux on a multia (ev4 alpha).  We got an illegal
</EM><BR>
<EM>&gt; &gt;instruction exception.  We discovered that it was compiled for ev6, and so
</EM><BR>
<EM>&gt; &gt;contained instructions not supported by our CPU.
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt;So we have patched the linux kernel to emulate the instructions we needed.
</EM><BR>
<EM>&gt; &gt;These instructions are:
</EM><BR>
<EM>&gt; &gt;- byte/word load/store instructions (ldbu,stb,ldwu,stw)
</EM><BR>
<EM>&gt; &gt;- some multimedia instructions (minsw, maxsw, minuw, maxuw, minsb, maxsb,
</EM><BR>
<EM>&gt; &gt;  minub, maxub)
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt;We have tried to make the emulation fairly fast - we have added it as some
</EM><BR>
<EM>&gt; &gt;assembly language code to the &quot;illegal instruction exception&quot; kernel entry
</EM><BR>
<EM>&gt; &gt;point in arch/alpha/kernel/entry.S:entIF.  (Of course it's still faster
</EM><BR>
<EM>&gt; &gt;to avoid emulation and use a binary compiled for your generation of alpha
</EM><BR>
<EM>&gt; &gt;cpu).
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt;We put an option for enabling it in the &quot;Kernel Hacking&quot; section of the
</EM><BR>
<EM>&gt; &gt;configuration.
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt;The patch is applied to kernel version 2.2.11
</EM><BR>
<EM>&gt; &gt;(Loki say not to use 2.2.12 for Civilization CTP)
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt;We only wrote enough emulation code to get CivilizationCTP to run ..  in the
</EM><BR>
<EM>&gt; &gt;future it would be cool to see emulation of a more complete set of
</EM><BR>
<EM>&gt; &gt;instructions in the kernel.
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt;Hope this is useful to somebody,
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt;Luke Deller &amp; Daniel Potts.
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt;--------------------------------------------------------------------------
</EM><BR>
<EM>&gt; &gt;           Luke Deller                               luked@cse.unsw.edu.au
</EM><BR>
<EM>&gt; &gt; _--_|\    Computer Engineering student
</EM><BR>
<EM>&gt; &gt;/      \   School of Computer Science and Engineering     ? ? ? ?
</EM><BR>
<EM>&gt; &gt;\_.--._*   The University of New South Wales               ~~^^~
</EM><BR>
<EM>&gt; &gt;      v    Sydney, NSW     2052    AUSTRALIA                o o
</EM><BR>
<EM>&gt; &gt;-------------------------------------------------------ooO--(_)--Ooo------
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt;--
</EM><BR>
<EM>&gt; &gt;To unsubscribe: send e-mail to axp-list-request@redhat.com with
</EM><BR>
<EM>&gt; &gt;'unsubscribe' as the subject.  Do not send it to axp-list@redhat.com
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt; &gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; --
</EM><BR>
<EM>&gt; To unsubscribe: send e-mail to axp-list-request@redhat.com with
</EM><BR>
<EM>&gt; 'unsubscribe' as the subject.  Do not send it to axp-list@redhat.com
</EM><BR>
<P><PRE>
-- 
To unsubscribe: send e-mail to axp-list-request@redhat.com with
'unsubscribe' as the subject.  Do not send it to axp-list@redhat.com
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0332.html">Kirk R. Erichsen: "RE: PATCH: (on Alpha) emulating missing instructions"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0330.html">Vanco, Donald: "RE: DS10 clock problem?"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0332.html">Kirk R. Erichsen: "RE: PATCH: (on Alpha) emulating missing instructions"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0333.html">Jemiolo, John: "RE: PATCH: (on Alpha) emulating missing instructions"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0332.html">Peter Rival: "Re: PATCH: (on Alpha) emulating missing instructions"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Thu Nov 04 1999 - 16:56:51 PST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
