<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>axp-list: RE: PATCH: (on Alpha) emulating missing instructions</TITLE>
<META NAME="Author" CONTENT="Jemiolo, John (John.Jemiolo@compaq.com)">
<META NAME="Subject" CONTENT="RE: PATCH: (on Alpha) emulating missing instructions">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>RE: PATCH: (on Alpha) emulating missing instructions</H1>
<HR>
<P>
<!-- received="Fri Oct 15 17:11:01 1999" -->
<!-- isoreceived="19991016001101" -->
<!-- sent="Fri, 15 Oct 1999 10:39:23 -0400" -->
<!-- isosent="19991015143923" -->
<!-- name="Jemiolo, John" -->
<!-- email="John.Jemiolo@compaq.com" -->
<!-- subject="RE: PATCH: (on Alpha) emulating missing instructions" -->
<!-- id="C98EB92F42B9D11197EA0000F806268E02A63B64@pkoexc4.pko.dec.com" -->
<!-- inreplyto="PATCH: (on Alpha) emulating missing instructions" -->
<STRONG>Subject: </STRONG>RE: PATCH: (on Alpha) emulating missing instructions<BR>
<STRONG>From: </STRONG>Jemiolo, John (<EM>John.Jemiolo@compaq.com</EM>)<BR>
<STRONG>Date: </STRONG>Fri Oct 15 1999 - 07:39:23 PDT
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#333">[ date ]</A>
<A HREF="index.html#333">[ thread ]</A>
<A HREF="subject.html#333">[ subject ]</A>
<A HREF="author.html#333">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0334.html">Michal Jaegermann: "Re: PATCH: (on Alpha) emulating missing instructions"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0332.html">Kirk R. Erichsen: "RE: PATCH: (on Alpha) emulating missing instructions"</A>
<LI><STRONG>Maybe in reply to:</STRONG> <A HREF="0327.html">Eric Bohm: "PATCH: (on Alpha) emulating missing instructions"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0350.html">Paul Jakma: "RE: PATCH: (on Alpha) emulating missing instructions"</A>
<LI><STRONG>Maybe reply:</STRONG> <A HREF="0327.html">Jemiolo, John: "RE: PATCH: (on Alpha) emulating missing instructions"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
Which is why you should use SRM Unix, if its available on your platform,
<BR>
Instead of (ARC or AlphaBios)  milo.  With SRM the palcode is updated with
<BR>
the firmware update releases (If needed).
<BR>
<P>I know this is a problem for the old NT-only systems which only have ARC or
<BR>
AlphaBios, but this is not true for current stuff, even the NT only
<BR>
white-box (33XX, 53XX, 73XX) systems have SRM, they just can't run unix or
<BR>
VMS, but run linux just fine (from SRM).
<BR>
<P>JJ
<BR>
<P><P>-----Original Message-----
<BR>
From: Kirk R. Erichsen [mailto:kirke@inteli-home.com]
<BR>
Sent: Friday, October 15, 1999 10:20 AM
<BR>
To: axp-list@redhat.com
<BR>
Subject: RE: PATCH: (on Alpha) emulating missing instructions
<BR>
<P><P>You better believe we are missing PALcode updates.  The PALcode in MILO
<BR>
dates back to the EB series machines and was part of the EBSDK.  The
<BR>
PALcode was built from examples from the SDK and are fairly close to the
<BR>
Digital UNIX 3.2 versions.  There are a lot of unimplemented functions and
<BR>
it is quite old.  If Compaq is serious about Alpha, we need PALcode
<BR>
updates, not more kernel hacks.
<BR>
The fact that Linux works over Alpha at all is in spite of, not because of
<BR>
support from Compaq.
<BR>
<P>--Kirk
<BR>
<P>At 12:03 PM 10/15/99 +0200, you wrote:
<BR>
<EM>&gt;Eminently done, but I was really under the impression that these exceptions
</EM><BR>
<EM>&gt;should be handled by the PALcode (since it is really a general Alpha
</EM><BR>
<EM>&gt;problem, not Linux-specific)? Is this not so (i.e. are we missing some
</EM><BR>
<EM>&gt;PALcode update) or is it solved differently in different OSes?
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;-----Original Message-----
</EM><BR>
<EM>&gt;From: Luke Deller [mailto:luked@cse.unsw.edu.au]
</EM><BR>
<EM>&gt;Sent: Friday, October 15, 1999 11:39 AM
</EM><BR>
<EM>&gt;To: axp-list@redhat.com
</EM><BR>
<EM>&gt;Cc: axp-list@redhat.com; Daniel Paul Potts
</EM><BR>
<EM>&gt;Subject: PATCH: (on Alpha) emulating missing instructions
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;Daniel &amp; I tried to run Loki's new beta version of Civilization Call to
</EM><BR>
<EM>&gt;Power for alpha linux on a multia (ev4 alpha).  We got an illegal
</EM><BR>
<EM>&gt;instruction exception.  We discovered that it was compiled for ev6, and so
</EM><BR>
<EM>&gt;contained instructions not supported by our CPU.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;So we have patched the linux kernel to emulate the instructions we needed.
</EM><BR>
<EM>&gt;These instructions are:
</EM><BR>
<EM>&gt;- byte/word load/store instructions (ldbu,stb,ldwu,stw)
</EM><BR>
<EM>&gt;- some multimedia instructions (minsw, maxsw, minuw, maxuw, minsb, maxsb,
</EM><BR>
<EM>&gt;  minub, maxub)
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;We have tried to make the emulation fairly fast - we have added it as some
</EM><BR>
<EM>&gt;assembly language code to the &quot;illegal instruction exception&quot; kernel entry
</EM><BR>
<EM>&gt;point in arch/alpha/kernel/entry.S:entIF.  (Of course it's still faster
</EM><BR>
<EM>&gt;to avoid emulation and use a binary compiled for your generation of alpha
</EM><BR>
<EM>&gt;cpu).
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;We put an option for enabling it in the &quot;Kernel Hacking&quot; section of the
</EM><BR>
<EM>&gt;configuration.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;The patch is applied to kernel version 2.2.11
</EM><BR>
<EM>&gt;(Loki say not to use 2.2.12 for Civilization CTP) 
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;We only wrote enough emulation code to get CivilizationCTP to run ..  in
</EM><BR>
the
<BR>
<EM>&gt;future it would be cool to see emulation of a more complete set of
</EM><BR>
<EM>&gt;instructions in the kernel.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;Hope this is useful to somebody,
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;Luke Deller &amp; Daniel Potts.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;--------------------------------------------------------------------------
</EM><BR>
<EM>&gt;           Luke Deller                               luked@cse.unsw.edu.au
</EM><BR>
<EM>&gt; _--_|\    Computer Engineering student           
</EM><BR>
<EM>&gt;/      \   School of Computer Science and Engineering     ? ? ? ?        
</EM><BR>
<EM>&gt;\_.--._*   The University of New South Wales               ~~^^~  
</EM><BR>
<EM>&gt;      v    Sydney, NSW     2052    AUSTRALIA                o o
</EM><BR>
<EM>&gt;-------------------------------------------------------ooO--(_)--Ooo------
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;-- 
</EM><BR>
<EM>&gt;To unsubscribe: send e-mail to axp-list-request@redhat.com with
</EM><BR>
<EM>&gt;'unsubscribe' as the subject.  Do not send it to axp-list@redhat.com
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<P><PRE>
-- 
To unsubscribe: send e-mail to axp-list-request@redhat.com with
'unsubscribe' as the subject.  Do not send it to axp-list@redhat.com
<P>-- 
To unsubscribe: send e-mail to axp-list-request@redhat.com with
'unsubscribe' as the subject.  Do not send it to axp-list@redhat.com
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0334.html">Michal Jaegermann: "Re: PATCH: (on Alpha) emulating missing instructions"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0332.html">Kirk R. Erichsen: "RE: PATCH: (on Alpha) emulating missing instructions"</A>
<LI><STRONG>Maybe in reply to:</STRONG> <A HREF="0327.html">Eric Bohm: "PATCH: (on Alpha) emulating missing instructions"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0350.html">Paul Jakma: "RE: PATCH: (on Alpha) emulating missing instructions"</A>
<LI><STRONG>Maybe reply:</STRONG> <A HREF="0327.html">Jemiolo, John: "RE: PATCH: (on Alpha) emulating missing instructions"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Thu Nov 04 1999 - 16:56:51 PST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
