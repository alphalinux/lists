<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>axp-list: Re: threaded apps crash in 2.2.10 on Alpha</TITLE>
<META NAME="Author" CONTENT="Richard Henderson (rth@twiddle.net)">
<META NAME="Subject" CONTENT="Re: threaded apps crash in 2.2.10 on Alpha">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: threaded apps crash in 2.2.10 on Alpha</H1>
<HR>
<P>
<!-- received="Tue Jul 06 10:48:08 1999" -->
<!-- isoreceived="19990706174808" -->
<!-- sent="Mon, 5 Jul 1999 19:10:37 -0700" -->
<!-- isosent="19990706021037" -->
<!-- name="Richard Henderson" -->
<!-- email="rth@twiddle.net" -->
<!-- subject="Re: threaded apps crash in 2.2.10 on Alpha" -->
<!-- id="19990705191037.A24683@twiddle.net" -->
<!-- inreplyto="4w7lol4xkh.fsf@colargol.tihlde.org" -->
<STRONG>Subject: </STRONG>Re: threaded apps crash in 2.2.10 on Alpha<BR>
<STRONG>From: </STRONG>Richard Henderson (<EM>rth@twiddle.net</EM>)<BR>
<STRONG>Date: </STRONG>Mon Jul 05 1999 - 19:10:37 PDT
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#68">[ date ]</A>
<A HREF="index.html#68">[ thread ]</A>
<A HREF="subject.html#68">[ subject ]</A>
<A HREF="author.html#68">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0069.html">RaymondInFinland: "webcam and alphalinux"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0067.html">Michal Jaegermann: "Re: Finally booted RH6, but [p|th]ings still go wrong"</A>
<!-- nextthread="start" -->
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
On Wed, Jun 30, 1999 at 03:39:26PM +0200, Einar Floystad Dorum wrote:
<BR>
<EM>&gt; On my SX164 running RH 6.0 (glibc 2.1, egcs 1.1.2) any program using
</EM><BR>
<EM>&gt; pthread will segfault or do an invalid instruction after a short
</EM><BR>
<EM>&gt; time. This happens on both 2.2.10 and 2.2.11-pre1 + Richard
</EM><BR>
<EM>&gt; Henderson's d-2211-rth1.gz. The enclosed pthread test program will
</EM><BR>
<EM>&gt; always segfault inside one of the pthread_* calls.
</EM><BR>
<P>Indeed. 
<BR>
<P>Somehow, while guessing how things might could be optimized, I forgot
<BR>
that flush_tlb_mm allocates new ASNs.  So all the hemming and hawing
<BR>
about tss.mm_context was garbage.  We have to copy the mm-&gt;context
<BR>
into tss.asn every time we're scheduled.  Without fail.
<BR>
<P>Here's a patch against 2.2.11-rth1.
<BR>
<P>Thanks for the wonderful test case.
<BR>
<P><P>r~
<BR>
<P><P><HR>
<UL>
<LI>text/plain attachment: <A HREF="att-v-2211-rth2_">-2211-rth2_</A>
</UL>
<!-- attachment="att-v-2211-rth2_" -->
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0069.html">RaymondInFinland: "webcam and alphalinux"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0067.html">Michal Jaegermann: "Re: Finally booted RH6, but [p|th]ings still go wrong"</A>
<!-- nextthread="start" -->
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Sun Aug 01 1999 - 06:12:34 PDT</EM>
</EM>
</SMALL>
</BODY>
</HTML>
