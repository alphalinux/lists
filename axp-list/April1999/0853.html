<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>axp-list: Re: Fix for asm/system.h</TITLE>
<META NAME="Author" CONTENT="Phil Carmody (carmody@cpd.ntc.nokia.com)">
<META NAME="Subject" CONTENT="Re: Fix for asm/system.h">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: Fix for asm/system.h</H1>
<HR>
<P>
<!-- received="Fri Apr 30 11:10:13 1999 PDT" -->
<!-- sent="Fri, 30 Apr 1999 12:09:57 +0100" -->
<!-- name="Phil Carmody" -->
<!-- email="carmody@cpd.ntc.nokia.com" -->
<!-- subject="Re: Fix for asm/system.h" -->
<!-- id="199904301109.MAA16730@mvagusta" -->
<!-- inreplyto="199904292122.XAA37874@vmax.unix-ag.uni-siegen.de" -->
<STRONG>Phil Carmody</STRONG> (<A HREF="mailto:carmody@cpd.ntc.nokia.com?subject=Re:%20Fix%20for%20asm/system.h"><EM>carmody@cpd.ntc.nokia.com</EM></A>)<BR>
<EM>Fri, 30 Apr 1999 12:09:57 +0100</EM>
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#853">[ date ]</A>
<A HREF="index.html#853">[ thread ]</A>
<A HREF="subject.html#853">[ subject ]</A>
<A HREF="author.html#853">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Previous message:</STRONG> <A HREF="0852.html">John Connett: "Accelerated-X w. Permedia 2?"</A>
<!-- nextthread="start" -->
</UL>
<HR>
<!-- body="start" -->
<P>
<EM>&gt;&gt;&gt;&gt;&gt; &quot;Nils&quot; == Nils Faerber &lt;<A HREF="mailto:Nils.Faerber@unix-ag.org?subject=Re:%20Fix%20for%20asm/system.h">Nils.Faerber@unix-ag.org</A>&gt; writes:
</EM><BR>
<P>My view is highly dependent on what system.h actually contains (viz. the
<BR>
type of ptr), I don't have access to the file at the moment, however, I
<BR>
would say: 
<BR>
Never use an explicit cast solely to silence a compiler warning.
<BR>
The action being preformed by the code remains the same, if it's dangerous
<BR>
let is be flagged as such.
<BR>
(And why is code with switch statements in a header file?)
<BR>
<P>Phil
<BR>
<P><EM>Nils&gt; Hello!
</EM><BR>
<EM>Nils&gt; While compiling a C++ program I noticed a little nastiness in asm/system.h
</EM><BR>
<EM>Nils&gt; (for Alpha of course). G++ always complained that an implicit cast would not
</EM><BR>
<EM>Nils&gt; be allowed with ANSI C++. OK I thought, then make it explicit ;)
</EM><BR>
<EM>Nils&gt; Here is a little diff... would someone please include this for the next
</EM><BR>
<EM>Nils&gt; kernel release?
</EM><BR>
<EM>Nils&gt; Thanks!
</EM><BR>
<EM>Nils&gt; CU
</EM><BR>
<EM>Nils&gt;   nils
</EM><BR>
<P><EM>Nils&gt; *** /usr/src/linux-2.2.6/include/asm/system.h	Thu Apr  1 00:00:29 1999
</EM><BR>
<EM>Nils&gt; --- system.h	Thu Apr 29 17:01:37 1999
</EM><BR>
<EM>Nils&gt; ***************
</EM><BR>
<EM>Nils&gt; *** 292,300 ****
</EM><BR>
<EM>Nils&gt;   {
</EM><BR>
<EM>Nils&gt;   	switch (size) {
</EM><BR>
<EM>Nils&gt;   		case 4:
</EM><BR>
<EM>Nils&gt; ! 			return xchg_u32(ptr, x);
</EM><BR>
<EM>Nils&gt;   		case 8:
</EM><BR>
<EM>Nils&gt; ! 			return xchg_u64(ptr, x);
</EM><BR>
<EM>Nils&gt;   	}
</EM><BR>
<EM>Nils&gt;   	__xchg_called_with_bad_pointer();
</EM><BR>
<EM>Nils&gt;   	return x;
</EM><BR>
<EM>Nils&gt; --- 292,300 ----
</EM><BR>
<EM>Nils&gt;   {
</EM><BR>
<EM>Nils&gt;   	switch (size) {
</EM><BR>
<EM>Nils&gt;   		case 4:
</EM><BR>
<EM>Nils&gt; ! 			return xchg_u32((volatile int *)ptr, x);
</EM><BR>
<EM>Nils&gt;   		case 8:
</EM><BR>
<EM>Nils&gt; ! 			return xchg_u64((volatile long *)ptr, x);
</EM><BR>
<EM>Nils&gt;   	}
</EM><BR>
<EM>Nils&gt;   	__xchg_called_with_bad_pointer();
</EM><BR>
<EM>Nils&gt;   	return
</EM><BR>
<P><PRE>
-- 
To unsubscribe: send e-mail to <A HREF="mailto:axp-list-request@redhat.com?subject=Re:%20Fix%20for%20asm/system.h">axp-list-request@redhat.com</A> with
'unsubscribe' as the subject.  Do not send it to <A HREF="mailto:axp-list@redhat.com?subject=Re:%20Fix%20for%20asm/system.h">axp-list@redhat.com</A>
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Previous message:</STRONG> <A HREF="0852.html">John Connett: "Accelerated-X w. Permedia 2?"</A>
<!-- nextthread="start" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.landfield.com/hypermail/">hypermail 2.0b3</A> 
on <EM>Fri Apr 30 1999 - 05:00:13 PDT</EM>
</EM>
</SMALL>
</BODY>
</HTML>
