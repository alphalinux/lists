<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>axp-list: Re: rpcc</TITLE>
<META NAME="Author" CONTENT="Richard Henderson (rth@twiddle.net)">
<META NAME="Subject" CONTENT="Re: rpcc">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: rpcc</H1>
<HR>
<P>
<!-- received="Tue Jan 12 19:28:21 1999 PST" -->
<!-- sent="Tue, 12 Jan 1999 11:27:51 -0800" -->
<!-- name="Richard Henderson" -->
<!-- email="rth@twiddle.net" -->
<!-- subject="Re: rpcc" -->
<!-- id="19990112112751.A5014@piglet.twiddle.net" -->
<!-- inreplyto="278f407d.u10t12e.e7d00-axp@amazing.ch" -->
<STRONG>Richard Henderson</STRONG> (<A HREF="mailto:rth@twiddle.net?subject=Re:%20rpcc"><EM>rth@twiddle.net</EM></A>)<BR>
<EM>Tue, 12 Jan 1999 11:27:51 -0800</EM>
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#629">[ date ]</A>
<A HREF="index.html#629">[ thread ]</A>
<A HREF="subject.html#629">[ subject ]</A>
<A HREF="author.html#629">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0630.html">Maurice Hilarius: "Re: 64bit PCI slots ?"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0628.html">Bob Taylor: "Re: Help! Can't recover!"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0612.html">Adam C. Powell, IV: "Re: Help!  Can't recover!"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0633.html">Wes Bauske: "Re: rpcc"</A>
</UL>
<HR>
<!-- body="start" -->
<P>
On Tue, Jan 12, 1999 at 04:59:00PM +0000, Christoph Dworzak wrote:
<BR>
<EM>&gt; &gt; (2) page colouring.  this affects the efficiency of the caches.
</EM><BR>
<EM>&gt; &gt;     there is no way under linux to control your page colour.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; What is page colouring? Could you explain this or do you
</EM><BR>
<EM>&gt; know where I can read about it?
</EM><BR>
<P>It should be found in most operating system or system architecture
<BR>
textbooks, in the location in which they talk about memory caches.
<BR>
<P>Caches work by indexing off the middle bits of an address, also
<BR>
referred to as the address' `colour'.  The exact range of middle bits
<BR>
has to do with the cache line size on the low end, and the size of
<BR>
the cache / set associativeness of the cache on the high end.
<BR>
<P>If the high bits of two addresses are different, but their colours
<BR>
are the same, the two addresses alias.  The set associativeness
<BR>
of the cache determines how many aliases we can have in the cache
<BR>
at one time.
<BR>
<P>If the physical memory for a process is all contiguous, we get the
<BR>
maximal distribution of colours, and so optimal cache efficiency.
<BR>
This rarely happens in practice.
<BR>
<P>What does happen is that, due to physical memory fragmentation, the
<BR>
kernel uses a page from here and a page from there.  On a system
<BR>
that has been up a while, the colour any particular page a process
<BR>
owns is effectively random.
<BR>
<P>Worst case, one could receive a set of pages all with the same colour.
<BR>
In this case the process would spend a great deal of its time waiting
<BR>
on main memory because cache efficiency would be abysmal.  This also
<BR>
rarely happens in practice.
<BR>
<P>DaveM experimented with page colouring allocator -- one that would
<BR>
be more likely to give a maximal distribution of colours -- midway
<BR>
through the 2.1 series.  But on top of the buddy-system page allocation
<BR>
system we have, that lead to serious memory fragmentation, fell over
<BR>
and died in low memory situations.
<BR>
<P>Perhaps it will be revisited in the 2.3 series; who knows.  It's only
<BR>
a real issue for benchmarks, when one wants to have reproducible numbers,
<BR>
so it's a fairly low-priority thing.
<BR>
<P><P>r~
<BR>
<P><PRE>
-- 
To unsubscribe: send e-mail to <A HREF="mailto:axp-list-request@redhat.com?subject=Re:%20rpcc">axp-list-request@redhat.com</A> with
'unsubscribe' as the subject.  Do not send it to <A HREF="mailto:axp-list@redhat.com?subject=Re:%20rpcc">axp-list@redhat.com</A>
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0630.html">Maurice Hilarius: "Re: 64bit PCI slots ?"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0628.html">Bob Taylor: "Re: Help! Can't recover!"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0612.html">Adam C. Powell, IV: "Re: Help!  Can't recover!"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0633.html">Wes Bauske: "Re: rpcc"</A>
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.landfield.com/hypermail/">hypermail 2.0b3</A> 
on <EM>Sun Jan 24 1999 - 14:47:49 PST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
