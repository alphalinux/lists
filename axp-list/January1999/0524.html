<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>axp-list: Re: interesting observations...</TITLE>
<META NAME="Author" CONTENT="Cameron Simpson (cs@zip.com.au)">
<META NAME="Subject" CONTENT="Re: interesting observations...">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: interesting observations...</H1>
<HR>
<P>
<!-- received="Mon Jan 11 05:51:54 1999 PST" -->
<!-- sent="Mon, 11 Jan 1999 05:40:57 +0000" -->
<!-- name="Cameron Simpson" -->
<!-- email="cs@zip.com.au" -->
<!-- subject="Re: interesting observations..." -->
<!-- id="19990111164813-cameron-1-00149@byron.research.canon.com.au" -->
<!-- inreplyto="19990111013358.26681.qmail@hotmail.com" -->
<STRONG>Cameron Simpson</STRONG> (<A HREF="mailto:cs@zip.com.au?subject=Re:%20interesting%20observations..."><EM>cs@zip.com.au</EM></A>)<BR>
<EM>Mon, 11 Jan 1999 05:40:57 +0000</EM>
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#524">[ date ]</A>
<A HREF="index.html#524">[ thread ]</A>
<A HREF="subject.html#524">[ subject ]</A>
<A HREF="author.html#524">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0525.html">Michal Jaegermann: "Re: Encrypted passwords (was Re: in search of popd)"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0523.html">Ross A. Knepper: "udb death"</A>
<!-- nextthread="start" -->
</UL>
<HR>
<!-- body="start" -->
<P>
On 11 Jan 1999, in message &lt;<A HREF="mailto:19990111013358.26681.qmail@hotmail.com?subject=Re:%20interesting%20observations...">19990111013358.26681.qmail@hotmail.com</A>&gt;
<BR>
&nbsp;&nbsp;&quot;Designer 7&quot; &lt;<A HREF="mailto:designer_7@hotmail.com?subject=Re:%20interesting%20observations...">designer_7@hotmail.com</A>&gt; wrote:
<BR>
| I just recompiled egcs-1.1.1-release with a previous egcs-1.1.1-release 
<BR>
| that I compiled with egcs-1.0.3b. Here is an interesting observation:
<BR>
| 
<BR>
| egcs-1.1.1 g++ compiled with egcs-1.1.1
<BR>
| -rwxr-xr-x   1 root     root       118668 Jan 10 07:37 g++*
<BR>
| 
<BR>
| egcs-1.1.1 g++ compiled with egcs-1.0.3b
<BR>
| -rwxr-xr-x   1 root     root       248948 Dec 14 01:34 g++*
<BR>
| 
<BR>
| Note the huge difference in size.. what's going on?
<BR>
| 
<BR>
| Both were compiled with the same flags except I changed -O2 to -O3 and 
<BR>
| added -finline-functions during the second time around with egcs-1.1.1. 
<BR>
| I would expect these flags to make the output larger... but now it's 
<BR>
| less than half!
<BR>
<P>Hmm. What does the size(1) command say about those executbles?
<BR>
(My first suspect is symbol tables, but parhaps the code really is
<BR>
smaller...)
<BR>
<P>As regards size, heavier optionisation could readily produce smaller
<BR>
code, and inlining functions strips all that function call stuff, which
<BR>
could easily be a very big gain on small functions where trivial (or at
<BR>
least fairly simple) operations have been abstracted into functions for
<BR>
various reasons.
<BR>
<P>Consider the gains of inlining this:
<BR>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void incref(int *refp)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ *refp++;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<BR>
<P>in code which makes lots of reference counter updates. The optimizer
<BR>
could fold it down to a single instruction (or even optimise it out
<BR>
completely for transient changes i.e. &quot;incref(&amp;p.cnt); blah blah blah
<BR>
decref(&amp;p.cnt)&quot;) whereas without inlining there's a whoel function call
<BR>
setup, call, op-via-pointers, return. Potentially a large gain.
<BR>
<P>So, what's size(1) say about these images?
<BR>
<PRE>
--
Cameron Simpson, DoD#743        <A HREF="mailto:cs@zip.com.au?subject=Re:%20interesting%20observations...">cs@zip.com.au</A>        <A HREF="http://www.zip.com.au/~cs/">http://www.zip.com.au/~cs/</A>
<P>Loose lids kink squids.	- <A HREF="mailto:Jody.P.Levine@hydro.on.ca?subject=Re:%20interesting%20observations...">Jody.P.Levine@hydro.on.ca</A> DoD#275
<P><PRE>
-- 
To unsubscribe: send e-mail to <A HREF="mailto:axp-list-request@redhat.com?subject=Re:%20interesting%20observations...">axp-list-request@redhat.com</A> with
'unsubscribe' as the subject.  Do not send it to <A HREF="mailto:axp-list@redhat.com?subject=Re:%20interesting%20observations...">axp-list@redhat.com</A>
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0525.html">Michal Jaegermann: "Re: Encrypted passwords (was Re: in search of popd)"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0523.html">Ross A. Knepper: "udb death"</A>
<!-- nextthread="start" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.landfield.com/hypermail/">hypermail 2.0b3</A> 
on <EM>Sun Jan 24 1999 - 14:47:48 PST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
