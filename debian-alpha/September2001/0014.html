<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Debian Alpha List: Re: firewall/http problem with 2.4 kernel</TITLE>
<META NAME="Author" CONTENT="Craig Small (csmall@eye-net.com.au )">
<META NAME="Subject" CONTENT="Re: firewall/http problem with 2.4 kernel">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: firewall/http problem with 2.4 kernel</H1>
<HR>
<P>
<!-- received="Tue Sep 18 02:55:42 2001" -->
<!-- isoreceived="20010918095542" -->
<!-- sent="Tue, 18 Sep 2001 12:55:35 +1000" -->
<!-- isosent="20010918025535" -->
<!-- name="Craig Small" -->
<!-- email="csmall@eye-net.com.au " -->
<!-- subject="Re: firewall/http problem with 2.4 kernel" -->
<!-- id="20010918125535.C3249@eye-net.com.au" -->
<!-- inreplyto="E15iwil-0000At-00@thorax.bg.ic.ac.uk" -->
<STRONG>Subject: </STRONG>Re: firewall/http problem with 2.4 kernel<BR>
<STRONG>From: </STRONG>Craig Small (<EM>csmall@eye-net.com.au </EM>)<BR>
<STRONG>Date: </STRONG>Mon Sep 17 2001 - 19:55:35 PDT
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#14">[ date ]</A>
<A HREF="index.html#14">[ thread ]</A>
<A HREF="subject.html#14">[ subject ]</A>
<A HREF="author.html#14">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Previous message:</STRONG> <A HREF="0013.html">Edgar Denny: "Re: firewall/http problem with 2.4 kernel"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0013.html">Edgar Denny: "Re: firewall/http problem with 2.4 kernel"</A>
<!-- nextthread="start" -->
<LI><STRONG>Reply:</STRONG> <A HREF="0013.html">Craig Small: "Re: firewall/http problem with 2.4 kernel"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
On Mon, Sep 17, 2001 at 12:37:51PM +0100, Edgar Denny wrote:
<BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; I've looked at the firewall logs, the packets from my Alpha get through 
</EM><BR>
<EM>&gt; the firewall, but the response from the external http server is denied.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; At typical line from the log file is:
</EM><BR>
<EM>&gt; 24032:Sep 11 15:40:20 firewall kernel: Packet log: input - eth1 PROTO=6 209.116.70.80:80 155.198.83.63:34734 L=60 S=0x00 I=44910 F=0x4000 T=42 (#114)
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; The reason they are denied is because a firewall rule denies any incoming
</EM><BR>
<EM>&gt; http connections above port number 5999. Here the port number is 34734.
</EM><BR>
Why do you do that?  That sounds like a bad idea.  Just block 6000-6010
<BR>
if you're worried about X, better yet use the new funky established
<BR>
thingy in iptables.
<BR>
<P>Your alpha, as well as any other host, when it makes a TCP connection
<BR>
needs 4 magic numbers to identify the connection.
<BR>
&nbsp;source IP address - that's the alpha's IP
<BR>
&nbsp;destination IP address - DNS lookups the hostname to an IP (a RedHat
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;host huh :)
<BR>
&nbsp;destination TCP port, port 80 is default for http
<BR>
<P>Then last of all is the source port.  Most hosts choose any old number
<BR>
above 1024 that is not already used. They have a counter so they use
<BR>
1025, then 1026,.....
<BR>
You can say that your firewall rules will break the 5975th connection your 
<BR>
alpha makes and you'll have to wait for about 60,000 connections until it
<BR>
works again.
<BR>
<P><EM>&gt; Though I don't understand http clearly, presumably this is because it is
</EM><BR>
<EM>&gt; the port my machine opened to make the http connection in the first place.
</EM><BR>
Correct, the webserver swaps the source and destination ports and IP for
<BR>
the reply.
<BR>
<P><EM>&gt; Anyone have any idea why my Alpha is chosing such a high port number, and 
</EM><BR>
<EM>&gt; how can I fix it?
</EM><BR>
Fix the firewall rules.
<BR>
<P>&nbsp;&nbsp;- Craig
<BR>
<PRE>
-- 
Craig Small VK2XLZ  GnuPG:1C1B D893 1418 2AF4 45EE  95CB C76C E5AC 12CA DFA5
Eye-Net Consulting <A HREF="http://www.eye-net.com.au/">http://www.eye-net.com.au/</A>        &lt;csmall@eye-net.com.au&gt;
MIEEE &lt;csmall@ieee.org&gt;                 Debian developer &lt;csmall@debian.org&gt;
<P><P>-- 
To UNSUBSCRIBE, email to debian-alpha-request@lists.debian.org
with a subject of &quot;unsubscribe&quot;. Trouble? Contact listmaster@lists.debian.org
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Previous message:</STRONG> <A HREF="0013.html">Edgar Denny: "Re: firewall/http problem with 2.4 kernel"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0013.html">Edgar Denny: "Re: firewall/http problem with 2.4 kernel"</A>
<!-- nextthread="start" -->
<LI><STRONG>Reply:</STRONG> <A HREF="0013.html">Craig Small: "Re: firewall/http problem with 2.4 kernel"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Thu Nov 01 2001 - 07:26:54 PST</EM>
</EM>
</SMALL>
</BODY>
</HTML>
