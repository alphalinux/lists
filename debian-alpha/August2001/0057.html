<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Debian Alpha List: Re: A few patches for 2.4.x for Alpha...</TITLE>
<META NAME="Author" CONTENT="Andrea Arcangeli (andrea@suse.de)">
<META NAME="Subject" CONTENT="Re: A few patches for 2.4.x for Alpha...">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: A few patches for 2.4.x for Alpha...</H1>
<HR>
<P>
<!-- received="Tue Aug 07 15:09:43 2001" -->
<!-- isoreceived="20010807220943" -->
<!-- sent="Tue, 7 Aug 2001 16:46:16 +0200" -->
<!-- isosent="20010807144616" -->
<!-- name="Andrea Arcangeli" -->
<!-- email="andrea@suse.de" -->
<!-- subject="Re: A few patches for 2.4.x for Alpha..." -->
<!-- id="20010807164616.R31832@athlon.random" -->
<!-- inreplyto="C3C5B71D8EB6D411B53700902732B4343F7AFD@fergus.alpha-processor.com" -->
<STRONG>Subject: </STRONG>Re: A few patches for 2.4.x for Alpha...<BR>
<STRONG>From: </STRONG>Andrea Arcangeli (<EM>andrea@suse.de</EM>)<BR>
<STRONG>Date: </STRONG>Tue Aug 07 2001 - 07:46:16 PDT
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#57">[ date ]</A>
<A HREF="index.html#57">[ thread ]</A>
<A HREF="subject.html#57">[ subject ]</A>
<A HREF="author.html#57">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0058.html">Daniel Potts: "RE: A few patches for 2.4.x for Alpha..."</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0056.html">Falk Hueffner: "Re: Alpha milo bootdisks, can we use SuSes?"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0001.html">Daniel Potts: "RE: A few patches for 2.4.x for Alpha..."</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0048.html">Andrea Arcangeli: "Re: A few patches for 2.4.x for Alpha..."</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0001.html">Andrea Arcangeli: "Re: A few patches for 2.4.x for Alpha..."</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
On Wed, Aug 01, 2001 at 06:53:17PM -0400, Daniel Potts wrote:
<BR>
<EM>&gt; Attached is a (possibly temporary) patch for another 2.4 bug I found. This
</EM><BR>
<EM>&gt; time, executing something like the following code will cause a crash to srm
</EM><BR>
<EM>&gt; or an oops:
</EM><BR>
<EM>&gt; {
</EM><BR>
<EM>&gt;   unsigned long *myaddr = 0xffffffffffffc000;
</EM><BR>
<EM>&gt;   *myaddr = 7; /* bye bye */
</EM><BR>
<EM>&gt; }
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; It appears to me that the self-mapping entry in each task page table is
</EM><BR>
<EM>&gt; somehow getting corrupted, causing user mode permission bits to be set. I
</EM><BR>
<EM>&gt; don't even know why we have this mapping because a running kernel does not
</EM><BR>
<EM>&gt; use it. While the patch does make it go away, I'm still concerned that
</EM><BR>
<EM>&gt; something just happened to trash that memory. This one needs to be examined
</EM><BR>
<EM>&gt; closer.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Line 63 of linux-2.4.7/arch/alpha/mm/init.c
</EM><BR>
<P>I think the problem is that that is an entry in the pgd, it's not a pte,
<BR>
so it's a kind of corrupted entry in first place. I also don't know how
<BR>
can it be useful so I like your patch.
<BR>
<P><EM>&gt; Btw, the clrfen and illop bug patch (entry.S/proto.h/traps.c) need to be
</EM><BR>
<EM>&gt; applied to 2.2.x kernels also!
</EM><BR>
<P>are you sure you don't break backwards compatibility with this change
<BR>
(or you only wanted to include the illop patch)?
<BR>
<P>@@ -409,7 +426,7 @@
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
<BR>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 3: /* FEN fault */
<BR>
-               send_sig(SIGILL, current, 1);
<BR>
+               send_sig(SIGFPE, current, 1);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
<BR>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 4: /* opDEC */
<BR>
Andrea
<BR>
<P><P><PRE>
-- 
To UNSUBSCRIBE, email to debian-alpha-request@lists.debian.org
with a subject of &quot;unsubscribe&quot;. Trouble? Contact listmaster@lists.debian.org
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0058.html">Daniel Potts: "RE: A few patches for 2.4.x for Alpha..."</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0056.html">Falk Hueffner: "Re: Alpha milo bootdisks, can we use SuSes?"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0001.html">Daniel Potts: "RE: A few patches for 2.4.x for Alpha..."</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0048.html">Andrea Arcangeli: "Re: A few patches for 2.4.x for Alpha..."</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0001.html">Andrea Arcangeli: "Re: A few patches for 2.4.x for Alpha..."</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Thu Sep 06 2001 - 05:03:50 PDT</EM>
</EM>
</SMALL>
</BODY>
</HTML>
