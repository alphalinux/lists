<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Debian Alpha List: RE: A few patches for 2.4.x for Alpha...</TITLE>
<META NAME="Author" CONTENT="Daniel Potts (Daniel.Potts@api-networks.com)">
<META NAME="Subject" CONTENT="RE: A few patches for 2.4.x for Alpha...">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>RE: A few patches for 2.4.x for Alpha...</H1>
<HR>
<P>
<!-- received="Tue Aug 07 15:23:37 2001" -->
<!-- isoreceived="20010807222337" -->
<!-- sent="Tue, 7 Aug 2001 10:46:48 -0400 " -->
<!-- isosent="20010807144648" -->
<!-- name="Daniel Potts" -->
<!-- email="Daniel.Potts@api-networks.com" -->
<!-- subject="RE: A few patches for 2.4.x for Alpha..." -->
<!-- id="C3C5B71D8EB6D411B53700902732B4343F7B21@fergus.alpha-processor.com" -->
<!-- inreplyto="A few patches for 2.4.x for Alpha..." -->
<STRONG>Subject: </STRONG>RE: A few patches for 2.4.x for Alpha...<BR>
<STRONG>From: </STRONG>Daniel Potts (<EM>Daniel.Potts@api-networks.com</EM>)<BR>
<STRONG>Date: </STRONG>Tue Aug 07 2001 - 07:46:48 PDT
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#58">[ date ]</A>
<A HREF="index.html#58">[ thread ]</A>
<A HREF="subject.html#58">[ subject ]</A>
<A HREF="author.html#58">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0059.html">Andrea Arcangeli: "Re: A few patches for 2.4.x for Alpha..."</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0057.html">Andrea Arcangeli: "Re: A few patches for 2.4.x for Alpha..."</A>
<LI><STRONG>Maybe in reply to:</STRONG> <A HREF="0000.html">Christopher C. Chimelis: "A few patches for 2.4.x for Alpha..."</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0059.html">Andrea Arcangeli: "Re: A few patches for 2.4.x for Alpha..."</A>
<LI><STRONG>Maybe reply:</STRONG> <A HREF="0000.html">Daniel Potts: "RE: A few patches for 2.4.x for Alpha..."</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
<EM>&gt; 
</EM><BR>
<EM>&gt; &gt; Attached is a (possibly temporary) patch for another 2.4 
</EM><BR>
<EM>&gt; bug I found. This
</EM><BR>
<EM>&gt; &gt; time, executing something like the following code will 
</EM><BR>
<EM>&gt; cause a crash to srm
</EM><BR>
<EM>&gt; &gt; or an oops:
</EM><BR>
<EM>&gt; &gt; {
</EM><BR>
<EM>&gt; &gt;   unsigned long *myaddr = 0xffffffffffffc000;
</EM><BR>
<EM>&gt; &gt;   *myaddr = 7; /* bye bye */
</EM><BR>
<EM>&gt; &gt; }
</EM><BR>
<EM>&gt; &gt; 
</EM><BR>
<EM>&gt; &gt; It appears to me that the self-mapping entry in each task 
</EM><BR>
<EM>&gt; page table is
</EM><BR>
<EM>&gt; &gt; somehow getting corrupted, causing user mode permission 
</EM><BR>
<EM>&gt; bits to be set. I
</EM><BR>
<EM>&gt; &gt; don't even know why we have this mapping because a running 
</EM><BR>
<EM>&gt; kernel does not
</EM><BR>
<EM>&gt; &gt; use it. While the patch does make it go away, I'm still 
</EM><BR>
<EM>&gt; concerned that
</EM><BR>
<EM>&gt; &gt; something just happened to trash that memory. This one 
</EM><BR>
<EM>&gt; needs to be examined
</EM><BR>
<EM>&gt; &gt; closer.
</EM><BR>
<EM>&gt; &gt; 
</EM><BR>
<EM>&gt; &gt; Line 63 of linux-2.4.7/arch/alpha/mm/init.c
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; I think the problem is that that is an entry in the pgd, it's 
</EM><BR>
<EM>&gt; not a pte,
</EM><BR>
<EM>&gt; so it's a kind of corrupted entry in first place. I also 
</EM><BR>
<EM>&gt; don't know how
</EM><BR>
<EM>&gt; can it be useful so I like your patch.
</EM><BR>
<P>Yes, that is what I thought; do you know why 2.2.x isn't affected? I guess
<BR>
the page tables are built up more correctly.
<BR>
<P><EM>&gt; &gt; Btw, the clrfen and illop bug patch 
</EM><BR>
<EM>&gt; (entry.S/proto.h/traps.c) need to be
</EM><BR>
<EM>&gt; &gt; applied to 2.2.x kernels also!
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; are you sure you don't break backwards compatibility with this change
</EM><BR>
<EM>&gt; (or you only wanted to include the illop patch)?
</EM><BR>
<P>My mistake! Please remove this. This is the Tru64 way, but I agree with you,
<BR>
that we should leave it alone.
<BR>
<P>Cheers,
<BR>
Daniel
<BR>
<P><EM>&gt; @@ -409,7 +426,7 @@
</EM><BR>
<EM>&gt;                 break;
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt;               case 3: /* FEN fault */
</EM><BR>
<EM>&gt; -               send_sig(SIGILL, current, 1);
</EM><BR>
<EM>&gt; +               send_sig(SIGFPE, current, 1);
</EM><BR>
<EM>&gt;                 break;
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt;               case 4: /* opDEC */
</EM><BR>
<EM>&gt; Andrea
</EM><BR>
<EM>&gt; 
</EM><BR>
<P><P><PRE>
-- 
To UNSUBSCRIBE, email to debian-alpha-request@lists.debian.org
with a subject of &quot;unsubscribe&quot;. Trouble? Contact listmaster@lists.debian.org
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0059.html">Andrea Arcangeli: "Re: A few patches for 2.4.x for Alpha..."</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0057.html">Andrea Arcangeli: "Re: A few patches for 2.4.x for Alpha..."</A>
<LI><STRONG>Maybe in reply to:</STRONG> <A HREF="0000.html">Christopher C. Chimelis: "A few patches for 2.4.x for Alpha..."</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0059.html">Andrea Arcangeli: "Re: A few patches for 2.4.x for Alpha..."</A>
<LI><STRONG>Maybe reply:</STRONG> <A HREF="0000.html">Daniel Potts: "RE: A few patches for 2.4.x for Alpha..."</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Thu Sep 06 2001 - 05:03:50 PDT</EM>
</EM>
</SMALL>
</BODY>
</HTML>
