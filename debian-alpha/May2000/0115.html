<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>Debian Alpha List: Re: Not possible to compile kernel with woody</TITLE>
<META NAME="Author" CONTENT="Mikolaj J. Habryn (fe78734e@eris.rcpt.to)">
<META NAME="Subject" CONTENT="Re: Not possible to compile kernel with woody">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: Not possible to compile kernel with woody</H1>
<HR>
<P>
<!-- received="Wed May 24 10:00:20 2000" -->
<!-- isoreceived="20000524170020" -->
<!-- sent="23 May 2000 18:33:17 +1000" -->
<!-- isosent="20000523083317" -->
<!-- name="Mikolaj J. Habryn" -->
<!-- email="fe78734e@eris.rcpt.to" -->
<!-- subject="Re: Not possible to compile kernel with woody" -->
<!-- id="s2vwvklis36.fsf@mussel.ucc.gu.uwa.edu.au" -->
<!-- inreplyto="Mon, 22 May 2000 08:49:20 +0200&quot;" -->
<STRONG>Subject: </STRONG>Re: Not possible to compile kernel with woody<BR>
<STRONG>From: </STRONG>Mikolaj J. Habryn (<EM>fe78734e@eris.rcpt.to</EM>)<BR>
<STRONG>Date: </STRONG>Tue May 23 2000 - 01:33:17 PDT
<P>
<UL>
<LI><STRONG>Messages sorted by:</STRONG> 
<A HREF="date.html#115">[ date ]</A>
<A HREF="index.html#115">[ thread ]</A>
<A HREF="subject.html#115">[ subject ]</A>
<A HREF="author.html#115">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0116.html">Robert Martinovic: "UP1000 Question about partitions"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0114.html">Adam C Powell IV: "Re: How up to date is this?"</A>
<!-- nextthread="start" -->
<LI><STRONG>Maybe reply:</STRONG> <A HREF="0111.html">Mikolaj J. Habryn: "Re: Not possible to compile kernel with woody"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
<EM>&gt;&gt;&gt;&gt;&gt; &quot;JB&quot; == Jakob Borg &lt;jb@replicant.nu&gt; writes:
</EM><BR>
<P><EM>    JB&gt; However, trying to run &quot;make {,old,x,menu}config&quot; in
</EM><BR>
<EM>    JB&gt; newly distributed (non-patched) kernels (I tried 2.2.15 and
</EM><BR>
<EM>    JB&gt; 2.3.99pre8) fails with a segfault. 
</EM><BR>
<P>&nbsp;&nbsp;I finally got fed up with this and chased it down.
<BR>
<P>--- bash-2.04/unwind_prot.c.orig        Tue May 23 18:07:51 2000
<BR>
+++ bash-2.04/unwind_prot.c     Tue May 23 18:08:17 2000
<BR>
@@ -300,7 +300,7 @@
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (value == 0)
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bzero ((char *)s-&gt;desired_setting, size);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
<BR>
-       FASTCOPY (value, (char *)s-&gt;desired_setting, size);
<BR>
+       FASTCOPY (var, (char *)s-&gt;desired_setting, size);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<BR>
&nbsp;&nbsp;&nbsp;else
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s-&gt;desired_setting = value;
<BR>
<P>&nbsp;&nbsp;Simple, neh? Ha! In terms of hours spent per changed characters in
<BR>
patch, this ranks in my all time top ten. I'm also not entirely sure
<BR>
that it's correct, as I would have expected something this simple to
<BR>
cause a lot more problems.
<BR>
<P>&nbsp;&nbsp;If I /was/ certain, I would delicately and with all due respect
<BR>
suggest that the hoops that the unwind protection code jumps through
<BR>
w.r.t. sizeof(int)-sized data elements are either too much or too
<BR>
little.
<BR>
<P>&nbsp;&nbsp;Too much, since that special case obscured this buglet. Too little,
<BR>
since if you're concerned about speed, you could extend the principle
<BR>
out to special casing size &lt;= sizeof(long) and using a union in
<BR>
the appropriate place.
<BR>
<P>&nbsp;&nbsp;I was going to submit a patch to do the above, but having spent a
<BR>
little too long burrowing around in 35-stack-frame-deep coredumps and
<BR>
dealing with a foreign frame unwinding system whilst in pursuit of
<BR>
something that, at first blush, looks dead on for being a simple
<BR>
buffer overrun, I'm going to bed. I have a headache.
<BR>
<P>m.
<BR>
<P><P><PRE>
-- 
To UNSUBSCRIBE, email to debian-alpha-request@lists.debian.org
with a subject of &quot;unsubscribe&quot;. Trouble? Contact listmaster@lists.debian.org
</PRE>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0116.html">Robert Martinovic: "UP1000 Question about partitions"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0114.html">Adam C Powell IV: "Re: How up to date is this?"</A>
<!-- nextthread="start" -->
<LI><STRONG>Maybe reply:</STRONG> <A HREF="0111.html">Mikolaj J. Habryn: "Re: Not possible to compile kernel with woody"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.www.fts.frontec.se/~dast/hypermail/">hypermail 2a22</A> 
: <EM>Thu Jun 01 2000 - 09:46:26 PDT</EM>
</EM>
</SMALL>
</BODY>
</HTML>
